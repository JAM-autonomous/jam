(this.webpackJsonpJam=this.webpackJsonpJam||[]).push([[0],{11:function(e,t,n){e.exports={container:"styles_container__27zPF",hasWorkspace:"styles_hasWorkspace__35bpu",title:"styles_title__2N76P",icon:"styles_icon__1HAua",workspace:"styles_workspace__3ElHp",hamburger:"styles_hamburger__Many8",line:"styles_line__2quYi",menu:"styles_menu__U4OyW",item:"styles_item__2yL_F",activities:"styles_activities__3XMLR",feedbackButton:"styles_feedbackButton__3p7oD",actions:"styles_actions__103cl"}},115:function(e,t,n){e.exports={container:"styles_container__HZ07f"}},117:function(e,t,n){e.exports={container:"styles_container__3IYSa"}},120:function(e,t,n){e.exports={container:"styles_container__d6Ncq"}},127:function(e,t,n){},128:function(e,t,n){},13:function(e,t,n){e.exports={container:"styles_container__2ceuK",disabled:"styles_disabled__10k6G",label:"styles_label__1gj-5",wrapper:"styles_wrapper__Qginb",icon:"styles_icon__3V-2s",hasRemoteTrack:"styles_hasRemoteTrack__1oJ2g",video:"styles_video__3ct2I",fullScreen:"styles_fullScreen__2lRL9",controls:"styles_controls__2cyTN",close:"styles_close__123BB",mic:"styles_mic__1KuzU",offLabel:"styles_offLabel__2jPEe",onLabel:"styles_onLabel__uuFb9"}},199:function(e,t,n){"use strict";n.r(t);var a=n(1),s=n.n(a),i=n(109),r=n.n(i),c=(n(127),n(73)),o=n.n(c),l=(n(128),n(3)),u=n(17),d=n(8),h=n(10),f=function(e){localStorage.setItem("auth",JSON.stringify(e))},m=function(){var e=localStorage.getItem("auth");if(null!==e&&void 0!==e)return JSON.parse(e)},p=function(){localStorage.removeItem("auth")},g=function(){p(),window.location.reload()},j=n(56),_=n.n(j),v={VERSION:"0.3.3",PEER_JS_SERVER:{host:"peerjs-server-4zqef7rt7q-as.a.run.app",port:80},BACKEND_SERVER:"https://jam.autonomous.ai",SOCKET_SERVER:"wss://jam.autonomous.ai",SOCKET_SERVER_PATH:"/api/socket.io",IS_PRODUCTION:!0,iceServers:[{urls:"turn:34.123.205.86:1609?transport=udp",username:"Ty1",credential:"password"},{urls:"stun:34.123.205.86:1609"}],STATUS:{DISCONNECTED:"disconnected",FAILED:"failed",CONNECTED:"connected",CLOSED:"closed"},FIREBASE_CONFIG:{apiKey:"AIzaSyAsYPb7cxQSnQNjI7x4CTg-UbzxRQdE-Bg",authDomain:"pjam-293710.firebaseapp.com",databaseURL:"https://pjam-293710.firebaseio.com",projectId:"pjam-293710",storageBucket:"pjam-293710.appspot.com",messagingSenderId:"1098600099639",appId:"1:1098600099639:web:c0a3da15b6a1e9d7c234b2",measurementId:"G-RLBT5ZMKWZ"},AGORA_CONFIG:{AppId:"0f5df6f6a3a34bfcb830ace46b55c9a8"},GA_CONFIG:{trackingId:"G-H7HP1C81Y5"},AA_CONFIG:{API_KEY:"YCf3pMW4dFw4_Nl76q94JF8F5sqlNJUO"}},b=new(n(121).a)(v.IS_PRODUCTION?"prod":"dev","frontend"),O=b.createLog("Handle 403 Code"),y=n(28),x=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3;y.ToastsStore.success(e,t,"toast-message")},k=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3;y.ToastsStore.error(e,t,"toast-message")},N=v.BACKEND_SERVER,C=_.a.create({baseURL:N,timeout:1e4,headers:{"Content-Type":"application/json;charset=UTF-8"}});C.interceptors.request.use((function(e){return e}),(function(e){return Promise.reject(e)})),C.interceptors.response.use((function(e){var t=(e||{}).data||{},n=t.data,a=t.error;if(a)throw a;return n}),(function(e){var t=e.response,n=((t=void 0===t?{}:t).data||{}).errorMsg;return function(e,t){O.info(e.response);var n=e.response.status;O.info("status ",n),403===n&&t&&g()}(e,!0),Promise.reject(n||e)})),v.IS_PRODUCTION||(window.http=C);var S=C,w=n(7),T=n(4),A=n.n(T),I=n(6),E=n(122),R=n(112),L=b.createLog("Tracking"),U=new E.a({clientSecret:v.AA_CONFIG.API_KEY,debug:!v.IS_PRODUCTION}),M=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.platform,n={userId:null,userPseudoId:null},a=function(){var e=Object(I.a)(A.a.mark((function e(){var t,a;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,R.a.load();case 3:return t=e.sent,e.next=6,t.get();case 6:a=e.sent,n.userPseudoId=a.visitorId,L.info("Setup track service completed"),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),L.error("Can not finish setting up track service, but may be it still works");case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}(),s=function(e){return n.userId=e},i=function(e,a){U.trackEvent({eventName:e,eventParams:a,platform:t,userId:n.userId,userPseudoId:n.userPseudoId})},r=function(e){U.trackPageView({pageName:e,platform:t})};return{trackEvent:i,trackPage:r,setUserId:s,setup:a}}({platform:"web"}),P="CLICK_BUTTON_TRY_FOR_FREE",B="CLICK_BUTTON_START_JAMMING",F="CLICK_BUTTON_CONTINUE_LOGIN",H="CLICK_BUTTON_LOGIN",K="CLICK_BUTTON_RESEND_CODE",D="TYPE_INPUT_EMAIL",V="API_LOGIN_OTP_SUCCESS",J="API_LOGIN_OTP_FAIL",G="API_RESEND_OTP",Y="CLICK_BUTTON_MIC",Q="CLICK_BUTTON_SHARE_SCREEN",q="CLICK_BUTTON_SHARE_SCREEN_FULLSCREEN",W="CLICK_BUTTON_SHARE_SCREEN_MIC",z="CLICK_BUTTON_JOIN",Z="CLICK_BUTTON_INVITE_FROM_LISTROOM",X="CLICK_BUTTON_INVITE_FROM_MENU",$="CLICK_BUTTON_INVITE_FROM_EMPTY_LISTROOM",ee="CLICK_BUTTON_INVITE_SEND",te="CLICK_BUTTON_FEEDBACK_FROM_MENU",ne="CLICK_BUTTON_FEEDBACK_SEND",ae="CLICK_BUTTON_LOGOUT_FROM_MENU",se="CLICK_BUTTON_HAMBURGER_MENU",ie={PRESS_ENTER:{key:"action",value:"PRESS_ENTER"},AUTO:{key:"action",value:"AUTO"},TURN_ON:{key:"action",value:"TURN_ON"},TURN_OFF:{key:"action",value:"TURN_OFF"},CLOSE:{key:"action",value:"CLOSE"},OPEN:{key:"action",value:"OPEN"}},re={SUCCESS:{key:"status",value:"SUCCESS"},FAIL:{key:"status",value:"FAIL"}},ce="LANDING_PAGE",oe="HOME",le="LOGIN",ue=n(0),de=b.createLog("AuthService",{logToServer:!0}),he=new(function(){function e(){var t=this;Object(d.a)(this,e),this.loading=!1,this.isAuthenticated=!1,this.auth=void 0,this._onAuthChangeListener=[],this.logout=function(){!0!==t.loading&&(t.loading=!0,S.post("api/logout").then((function(e){if(!e)throw new Error("Logout failed");g(),t.auth=void 0,t.isAuthenticated=!1,t.triggerAuthChangeCallbacks(),t.loading=!1})).catch((function(e){t.loading=!1})))},this.verify=function(){!0!==t.loading&&(t.loading=!0,S.get("api/profile").then((function(e){t.loading=!1,t.isAuthenticated=!0})).catch((function(e){t.loading=!1})))},this.handleLogin=function(e,n){var a=e.token;t.isAuthenticated=!0,f(e),function(e){C.defaults.headers=Object(l.a)(Object(l.a)({},C.defaults.headers),{},{token:e})}(a),n&&n(e),t.auth=e,t.verify(),b.setUserId(e.id),b.setUserEmail(e.email),M.setUserId(e.email),de=b.createLog("AuthService",{logToServer:!0}),t.triggerAuthChangeCallbacks()},this.login=function(e,n){!0!==t.loading&&(t.loading=!0,S.post("api/login",{email:e.email,workspace:e.workspace}).then((function(e){t.loading=!1,t.handleLogin(e,n),de.info("login_request")})).catch((function(e){t.loading=!1})))},this.requestOtp=function(e,n){!0!==t.loading&&(t.loading=!0,S.post("api/login",{email:e}).then((function(e){t.loading=!1,n(e),de.info("login_request_otp")})).catch((function(e){t.loading=!1})))},this.verifyOtp=function(e,n){!0!==t.loading&&(t.loading=!0,S.post("api/complete-login",{code:e}).then((function(e){t.loading=!1,t.handleLogin(e,n),de.info("login_complete"),M.trackEvent(V)})).catch((function(e){t.loading=!1,k("This code is not valid. Please try again, or request a new one."),M.trackEvent(J)})))},this.resendOtp=function(e,n){!0!==t.loading&&(t.loading=!0,S.post("api/login",{email:e}).then((function(e){t.loading=!1,n(e),de.info("login_resend_otp"),x("New code sent."),M.trackEvent(G,[re.SUCCESS])})).catch((function(e){t.loading=!1,M.trackEvent(G,[re.FAIL])})))},this.invite=function(e,n){!0!==t.loading&&(t.loading=!0,S.post("api/invite",{emailList:e}).then((function(e){t.loading=!1,n(e)})).catch((function(e){t.loading=!1})))};var n=m();n&&(n.email&&this.handleLogin(n))}return Object(h.a)(e,[{key:"onAuthChange",value:function(e){this._onAuthChangeListener.push(e)}},{key:"triggerAuthChangeCallbacks",value:function(){var e=this;this._onAuthChangeListener.forEach((function(t){return t(e.auth)}))}}]),e}()),fe=he;function me(e){var t=e.children,n=Object(u.a)(e,["children"]),a=he;return Object(ue.jsx)(w.b,Object(l.a)(Object(l.a)({},n),{},{render:function(e){var n=e.location;return a.isAuthenticated&&a.auth?t:Object(ue.jsx)(w.a,{to:{pathname:"/get-started",state:{from:n}}})}}))}function pe(e){var t=e.children,n=Object(u.a)(e,["children"]),a=he;return Object(ue.jsx)(w.b,Object(l.a)(Object(l.a)({},n),{},{render:function(e){var n=e.location;return a.isAuthenticated&&a.auth?Object(ue.jsx)(w.a,{to:{pathname:"/",state:{from:n}}}):t}}))}var ge=n(27),je=n(58),_e=n.n(je),ve=n(44),be=n.n(ve),Oe=function(){return Object(ue.jsx)("div",{className:be.a.container,children:Object(ue.jsxs)("div",{className:be.a.wrapper,children:[Object(ue.jsx)("h3",{className:be.a.title,children:"Spontaneous, permissionless calling"}),Object(ue.jsx)("p",{className:be.a.description,children:"Sometimes a quick chat is all you need to get things done. Jam is simple click-to-talk, audio-first software without the endless fuss of Zoom links and Meet invites."}),Object(ue.jsxs)("div",{className:be.a.actions,children:[Object(ue.jsx)(ge.b,{to:"/login",onClick:function(){return M.trackEvent(P)},children:"Try for free"}),Object(ue.jsx)("div",{children:"No download required."})]})]})})},ye=n(34),xe=n.n(ye),ke=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.join(t.length>=2?" ":"")},Ne=function(e){return"string"===typeof e&&e.substr(0,e.indexOf("@"))},Ce=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},Se=function(e){for(var t=[],n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",a=n.length,s=0;s<e;s++)t.push(n.charAt(Math.floor(Math.random()*a)));return t.join("")},we=n.p+"static/media/preview-image.45fccd19.png",Te=n.p+"static/media/preview-image-mobile.42c654ba.png",Ae=function(){return Object(ue.jsx)("div",{className:xe.a.container,children:Object(ue.jsxs)("div",{className:xe.a.wrapper,children:[Object(ue.jsx)("img",{src:we,className:ke(xe.a.mainImage,xe.a.desk)}),Object(ue.jsx)("img",{src:Te,className:(xe.a.mainImage,xe.a.mobile)})]})})},Ie=n(76),Ee=n.n(Ie),Re=n(51),Le=n.n(Re),Ue=function(e){var t=e.icon,n=e.title,a=e.description;return Object(ue.jsxs)("div",{className:Le.a.container,children:[Object(ue.jsx)("img",{src:t,className:Le.a.icon}),Object(ue.jsx)("h3",{className:Le.a.title,dangerouslySetInnerHTML:{__html:n}}),Object(ue.jsx)("p",{className:Le.a.description,children:a})]})},Me=n.p+"static/media/f1-ic.db208a4f.svg",Pe=n.p+"static/media/f2-ic.780d0c10.svg",Be=n.p+"static/media/f3-ic.fed5349f.svg",Fe=function(){return Object(ue.jsx)("div",{className:Ee.a.container,children:Object(ue.jsxs)("div",{className:Ee.a.wrapper,children:[Object(ue.jsx)(Ue,{icon:Me,title:"Jam with anyone or everyone instantly",description:"Once you\u2019re logged in with your work email, simply click a colleague\u2019s name to talk or hop into an ongoing conversation. Connecting on Jam feels just like popping by someone\u2019s desk."}),Object(ue.jsx)(Ue,{icon:Pe,title:"This meeting could be <span>an email</span> on Jam",description:"Don\u2019t waste time juggling disjointed Slack threads. Don\u2019t kill your workflow with scheduled calls. Just get that quick yes or no, share what you\u2019re working on, and move on."}),Object(ue.jsx)(Ue,{icon:Be,title:"Have more productive conversations",description:"Jam prioritizes what matters. Audio is crisp and lag-free, so you can actually hear and be heard. And because anyone is just a click away, interactions are completely effortless."})]})})},He=n(59),Ke=n.n(He),De=function(){return Object(ue.jsxs)("div",{className:Ke.a.container,children:[Object(ue.jsx)("h3",{className:Ke.a.title,children:"Did we already say no download required?"}),Object(ue.jsx)("div",{className:Ke.a.action,children:Object(ue.jsx)(ge.b,{to:"/login",onClick:function(){return M.trackEvent(B)},children:"Start jamming"})})]})},Ve=n(77),Je=n.n(Ve),Ge=function(){return Object(ue.jsx)("div",{className:Je.a.container,children:Object(ue.jsx)("div",{className:Je.a.copyright,children:"2021 Autonomous, All Rights Reserved."})})};M.trackPage(ce);var Ye=function(){return Object(ue.jsxs)("div",{className:_e.a.container,children:[Object(ue.jsx)(Oe,{}),Object(ue.jsx)("div",{className:_e.a.fullWidth,children:Object(ue.jsx)(Ae,{})}),Object(ue.jsx)(Fe,{}),Object(ue.jsxs)("div",{className:_e.a.fullWidth,children:[Object(ue.jsx)(De,{}),Object(ue.jsx)(Ge,{})]})]})},Qe=n(12),qe=n(2),We=n(26),ze=n.n(We),Ze=n(49),Xe=b.createLog("agoraClient",{logToServer:!0});ze.a.setLogLevel(v.IS_PRODUCTION?3:0);var $e={mode:"rtc",codec:"vp8"},et={encoderConfig:"high_quality",AEC:!0,AGC:!0,ANS:!0},tt=function(){function e(t,n){var a=this;Object(d.a)(this,e),this.handleUserPublished=function(){var e=Object(I.a)(A.a.mark((function e(t,n){var s,i;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,Xe.verbose("handleUserPublished -  Info",t,n),"audio"!==n||!t.hasAudio){e.next=7;break}return e.next=5,a.clientAgora.subscribe(t,n);case 5:(s=e.sent)&&s.play();case 7:if("video"!==n||!t.hasVideo){e.next=12;break}return e.next=10,a.clientAgora.subscribe(t,n);case 10:(i=e.sent)&&a.triggerReceiveVideoTrack(i);case 12:e.next=18;break;case 14:throw e.prev=14,e.t0=e.catch(0),Xe.error("handleUserPublished failed, mediaType: ".concat(n,", uid: ").concat(t&&t.uid,", e: ").concat(e.t0.message)),e.t0;case 18:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(t,n){return e.apply(this,arguments)}}(),this.handleUserUnpublished=function(){var e=Object(I.a)(A.a.mark((function e(t,n){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,Xe.verbose("user-unpublished",t,n),"video"===n&&a.triggerRemoveVideoTrack(),e.next=5,a.clientAgora.unsubscribe(t,n);case 5:e.next=11;break;case 7:throw e.prev=7,e.t0=e.catch(0),Xe.critical("handleUserUnpublished failed, mediaType: ".concat(n,", e: ").concat(e.t0.message)),e.t0;case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,n){return e.apply(this,arguments)}}(),this.handleException=function(){var e=Object(I.a)(A.a.mark((function e(t){var n;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.clientAgora.getRTCStats();case 2:n=e.sent,Xe.critical("Agora exception with event: ".concat(JSON.stringify(t),", channelName: ").concat(a.channelName,", statsCall: ").concat(JSON.stringify(n)));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.handleNetworkQuality=function(e){e.downlinkNetworkQuality>=3&&Xe.info("downlinkNetworkQuality, channelName: ".concat(a.channelName,", stats: ").concat(e.downlinkNetworkQuality)),e.uplinkNetworkQuality>=3&&Xe.info("uplinkNetworkQuality, channelName: ".concat(a.channelName,", stats: ").concat(e.uplinkNetworkQuality))},this.handleUserInfoUpdated=function(e,t){switch(t){case"mute-audio":a.triggerUserInfoUpdated({agoraUserId:e,status:"muted"});break;case"unmute-audio":a.triggerUserInfoUpdated({agoraUserId:e,status:"unmuted"})}},this.handleVolumeIndicator=function(e){a.triggerVolumeIndicatorChange(e)},this.setMicrophone=Object(Ze.debounce)(function(){var e=Object(I.a)(A.a.mark((function e(t){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,a.microphone=t,a.localAudioTrack){e.next=6;break}return e.next=5,ze.a.createMicrophoneAudioTrack(et);case 5:a.localAudioTrack=e.sent;case 6:if("CONNECTED"!==a.clientAgora.connectionState||!a.localAudioTrack){e.next=14;break}if(!t){e.next=12;break}return e.next=10,a.clientAgora.publish(a.localAudioTrack);case 10:e.next=14;break;case 12:return e.next=14,a.clientAgora.unpublish(a.localAudioTrack);case 14:a.triggerMicrophoneUpdate(t),e.next=21;break;case 17:throw e.prev=17,e.t0=e.catch(0),Xe.critical("setMicrophone failed, e: ".concat(e.t0.message)),e.t0;case 21:case"end":return e.stop()}}),e,null,[[0,17]])})));return function(t){return e.apply(this,arguments)}}(),500);try{this.clientId=t,this.socket=n,this.clientAgora=ze.a.createClient($e),this.localAudioTrack=null,this.localScreenTrack=null,this.microphone=!0,this._onReceiveVideoTrackListener=[],this._onRemoveVideoTrackListener=[],this._onConnectionStateChangeListener=[],this._onMicrophoneUpdateListener=[],this._onSharingScreenStatusChangeListener=[],this._onUserInfoUpdatedListener=[],this._onVolumeIndicatorChangeListener=[],this.channelName=null,this.initSocketListener(),this.clientAgora.on("connection-state-change",(function(e){a.triggerConnectionStateChange(e)})),this.permissionOnchange(),this.onMicrophoneChanged(),Xe.info("Init client, uid: ",this.clientAgora.uid)}catch(s){throw Xe.critical("Init failed, clientId: ".concat(t,", error: ").concat(s.message)),s}}return Object(h.a)(e,[{key:"onMicrophoneChanged",value:function(){var e=this;ze.a.onMicrophoneChanged=function(){var t=Object(I.a)(A.a.mark((function t(n){var a,s;return A.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ze.a.getMicrophones(!1);case 2:if((a=t.sent)&&0!==a.length){t.next=5;break}return t.abrupt("return");case 5:(s=a.find((function(e){return"default"===e.deviceId})))&&e.localAudioTrack&&e.localAudioTrack.setDevice(s.deviceId);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}},{key:"permissionOnchange",value:function(){var e=this;navigator.permissions&&navigator.permissions.query({name:"microphone"}).then((function(t){t.onchange=function(){e.channelName&&("granted"===t.state||"prompt"===t.state?e.createAndPublishAudioTrack():e.destroyLocalAudioTrack())}}))}},{key:"onMicrophoneUpdate",value:function(e){"function"===typeof e&&this._onMicrophoneUpdateListener.push(e)}},{key:"onSharingScreenStatusChange",value:function(e){"function"===typeof e&&this._onSharingScreenStatusChangeListener.push(e)}},{key:"onConnectionStateChange",value:function(e){"function"===typeof e&&this._onConnectionStateChangeListener.push(e)}},{key:"onReceiveVideoTrack",value:function(e){"function"===typeof e&&this._onReceiveVideoTrackListener.push(e)}},{key:"onRemoveVideoTrack",value:function(e){"function"===typeof e&&this._onRemoveVideoTrackListener.push(e)}},{key:"onUserInfoUpdated",value:function(e){"function"===typeof e&&this._onUserInfoUpdatedListener.push(e)}},{key:"onVolumeIndicatorChange",value:function(e){"function"===typeof e&&this._onVolumeIndicatorChangeListener.push(e)}},{key:"triggerMicrophoneUpdate",value:function(e){this._onMicrophoneUpdateListener.forEach((function(t){return t(e)}))}},{key:"triggerReceiveVideoTrack",value:function(e){this._onReceiveVideoTrackListener.forEach((function(t){return t(e)}))}},{key:"triggerRemoveVideoTrack",value:function(){this._onRemoveVideoTrackListener.forEach((function(e){return e()}))}},{key:"triggerConnectionStateChange",value:function(e){this._onConnectionStateChangeListener.forEach((function(t){return t(e)}))}},{key:"triggerSharingScreenStateChange",value:function(e){this._onSharingScreenStatusChangeListener.forEach((function(t){return t(e)}))}},{key:"triggerUserInfoUpdated",value:function(e){this._onUserInfoUpdatedListener.forEach((function(t){return t(e)}))}},{key:"triggerVolumeIndicatorChange",value:function(e){this._onVolumeIndicatorChangeListener.forEach((function(t){return t(e)}))}},{key:"start",value:function(){var e=Object(I.a)(A.a.mark((function e(t,n,a){var s,i;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.clientAgora.on("user-published",this.handleUserPublished),this.clientAgora.on("user-unpublished",this.handleUserUnpublished),this.clientAgora.enableAudioVolumeIndicator(),e.next=5,this.clientAgora.join(v.AGORA_CONFIG.appId,t,n,null);case 5:if(s=e.sent){e.next=10;break}throw i="Cannot join channel: ".concat(t),Xe.critical(i),i;case 10:this.channelName=t,Xe.info("join a room, channelName: ".concat(t,", uid: ").concat(s)),this.clientAgora.on("exception",this.handleException),this.clientAgora.on("network-quality",this.handleNetworkQuality),this.clientAgora.on("user-info-updated",this.handleUserInfoUpdated),this.clientAgora.on("volume-indicator",this.handleVolumeIndicator),this.createAndPublishAudioTrack(),this.updateAgoraUserId(a,s);case 18:case"end":return e.stop()}}),e,this)})));return function(t,n,a){return e.apply(this,arguments)}}()},{key:"createAndPublishAudioTrack",value:function(){var e=Object(I.a)(A.a.mark((function e(){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ze.a.createMicrophoneAudioTrack(et);case 3:if(this.localAudioTrack=e.sent,!this.microphone||!this.localAudioTrack){e.next=7;break}return e.next=7,this.clientAgora.publish(this.localAudioTrack);case 7:e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),Xe.critical("CreateAndPublishAudioTrack failed, e: ".concat(e.t0.message)),k("Microphone permission denied");case 13:case"end":return e.stop()}}),e,this,[[0,9]])})));return function(){return e.apply(this,arguments)}}()},{key:"updateAgoraUserId",value:function(){var e=Object(I.a)(A.a.mark((function e(t,n){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.post("api/room/agora-user-id",{roomId:t,agoraUserId:n});case 2:Xe.info("updateAgoraUserId, roomId: ".concat(t,", agoraUserId: ").concat(n));case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"stop",value:function(){var e=Object(I.a)(A.a.mark((function e(){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.destroyLocalAudioTrack();case 3:if(!this.localScreenTrack){e.next=8;break}return this.localScreenTrack.stop(),this.localScreenTrack.close(),e.next=8,this.clientAgora.unpublish(this.localScreenTrack);case 8:if(!this.clientAgora){e.next=11;break}return e.next=11,this.clientAgora.leave();case 11:this.channelName=null,this.removeAllListeners(),e.next=19;break;case 15:throw e.prev=15,e.t0=e.catch(0),Xe.critical("stop failed, e: ".concat(e.t0.message)),e.t0;case 19:case"end":return e.stop()}}),e,this,[[0,15]])})));return function(){return e.apply(this,arguments)}}()},{key:"removeAllListeners",value:function(){var e=Object(I.a)(A.a.mark((function e(){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.clientAgora.removeAllListeners("user-published"),this.clientAgora.removeAllListeners("user-unpublished"),this.clientAgora.removeAllListeners("exception"),this.clientAgora.removeAllListeners("network-quality"),this.clientAgora.removeAllListeners("user-info-updated"),this.clientAgora.removeAllListeners("volume-indicator");case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"destroyLocalAudioTrack",value:function(){var e=Object(I.a)(A.a.mark((function e(){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.localAudioTrack){e.next=6;break}if(this.localAudioTrack.stop(),this.localAudioTrack.close(),!this.microphone){e.next=6;break}return e.next=6,this.clientAgora.unpublish(this.localAudioTrack);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"startScreenSharing",value:function(){var e=Object(I.a)(A.a.mark((function e(t){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t){e.next=14;break}return"1080p_2","disable",e.next=6,ze.a.createScreenVideoTrack({encoderConfig:"1080p_2"},"disable");case 6:if(this.localScreenTrack=e.sent,Xe.verbose("screenTrack",this.localScreenTrack),!this.localScreenTrack){e.next=12;break}return this.localScreenTrack.on("track-ended",this.endScreenSharing.bind(this)),e.next=12,this.clientAgora.publish(this.localScreenTrack);case 12:e.next=22;break;case 14:return e.next=16,ze.a.createCustomVideoTrack({mediaStreamTrack:t.getVideoTracks()[0]});case 16:if(this.localScreenTrack=e.sent,Xe.verbose("screenTrack",this.localScreenTrack),!this.localScreenTrack){e.next=22;break}return this.localScreenTrack.on("track-ended",this.endScreenSharing.bind(this)),e.next=22,this.clientAgora.publish(this.localScreenTrack);case 22:e.next=28;break;case 24:throw e.prev=24,e.t0=e.catch(0),Xe.error("startScreenSharing failed, e: ".concat(e.t0.message)),e.t0;case 28:case"end":return e.stop()}}),e,this,[[0,24]])})));return function(t){return e.apply(this,arguments)}}()},{key:"endScreenSharing",value:function(){var e=Object(I.a)(A.a.mark((function e(){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.triggerSharingScreenStateChange(!1),e.prev=1,this.localScreenTrack&&(this.localScreenTrack.stop(),this.localScreenTrack.close(),this.clientAgora.unpublish(this.localScreenTrack)),e.next=9;break;case 5:throw e.prev=5,e.t0=e.catch(1),Xe.error("endScreenSharing failed, e: ".concat(e.t0.message)),e.t0;case 9:case"end":return e.stop()}}),e,this,[[1,5]])})));return function(){return e.apply(this,arguments)}}()},{key:"initSocketListener",value:function(){var e=this;try{this.socket.on(this.clientId,function(){var t=Object(I.a)(A.a.mark((function t(n){return A.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=n.type,t.next="offerInfo"===t.t0?3:"answerInfo"===t.t0?6:"icecandidateInfo"===t.t0?7:8;break;case 3:return t.next=5,e.onOfferReceive(n.fromUserId,n.message);case 5:case 6:case 7:return t.abrupt("break",8);case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}catch(t){throw Xe.critical("initSocketListener failed, e: ".concat(t.message)),t}}},{key:"callToRemoteUsers",value:function(){var e=Object(I.a)(A.a.mark((function e(t,n,a,s){var i=this;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Xe.info("callToRemoteUsers, channelName: ".concat(t,", channelToken: ").concat(n,", remoteUserIds: ").concat(JSON.stringify(a))),e.next=3,this.start(t,n,s);case 3:a instanceof Array&&1===a.length&&a.forEach(function(){var e=Object(I.a)(A.a.mark((function e(a){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i.connect(a,t,n,s);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 4:case"end":return e.stop()}}),e,this)})));return function(t,n,a,s){return e.apply(this,arguments)}}()},{key:"connect",value:function(e,t,n,a){try{this.socket.emit("offer",JSON.stringify({toUserId:e,offerObj:{channelName:t,channelToken:n,roomId:a}}))}catch(s){throw Xe.critical("connect failed, e: ".concat(s.message)),s}}},{key:"onOfferReceive",value:function(){var e=Object(I.a)(A.a.mark((function e(t,n){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Xe.info("AgoraClient onOfferReceive ".concat(t)),n){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,this.start(n.channelName,n.channelToken,n.roomId);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}(),nt=n(43),at=n(42),st=n(114),it=b.createLog("Base Socket"),rt=function(){function e(t,n,a){Object(d.a)(this,e),this.ns=t,this.host=n,this.path=a||"",this.events={},this._prevSocket=null,this.auth=null}return Object(h.a)(e,[{key:"socket",get:function(){if(this.auth||(this.auth=fe.auth),!this.auth)throw new Error('Must run "init" with auth first');var e={query:{userId:this.auth.id},auth:{token:this.auth.token}};return""!=this.path&&(e.path=this.path),this._prevSocket=this._prevSocket||Object(st.io)("".concat(this.host,"/").concat(this.ns),e),this._prevSocket}},{key:"_callEvent",value:function(e){var t=this.events[e];if("function"===typeof t){for(var n=arguments.length,a=new Array(n>1?n-1:0),s=1;s<n;s++)a[s-1]=arguments[s];t.apply(void 0,a)}}},{key:"init",value:function(e){this.auth=e,this.listen()}},{key:"listen",value:function(){it.info('Implement "listen" here')}}]),e}(),ct=b.createLog("Room Socket"),ot="listroom",lt=new(function(e){Object(nt.a)(n,e);var t=Object(at.a)(n);function n(){var e;return Object(d.a)(this,n),(e=t.call(this,"room-management",v.SOCKET_SERVER,v.SOCKET_SERVER_PATH)).events={},e}return Object(h.a)(n,[{key:"onListRoom",value:function(e){this.events[ot]=e}},{key:"listen",value:function(){var e=this;this.socket.on("listroom",(function(t){ct.info("Got new list room",t),e._callEvent(ot,t)}))}}]),n}(rt)),ut=b.createLog("Signal Socket"),dt=new(function(e){Object(nt.a)(n,e);var t=Object(at.a)(n);function n(){return Object(d.a)(this,n),t.call(this,"signal-management",v.SOCKET_SERVER,v.SOCKET_SERVER_PATH)}return Object(h.a)(n,[{key:"listen",value:function(){var e=this;this.socket.on(this.userId,(function(e){ut.info("[SIGNAL data]",e)})),window.emit=function(t,n){return e.socket.emit("exchange",{id:t,data:n})}}}]),n}(rt)),ht=n(115),ft=n.n(ht),mt=n(116),pt=function(){function e(){Object(d.a)(this,e),this.items=[]}return Object(h.a)(e,[{key:"queue",value:function(e){this.items.push(e)}},{key:"dequeue",value:function(){return this.items.shift()}},{key:"sortByTime",value:function(){this.items=Object(Qe.a)(this.items).sort((function(e,t){return e.time-t.time}))}},{key:"run",value:function(){this.sortByTime();var e,t=Object(mt.a)(this.items);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.func(n.status)}}catch(a){t.e(a)}finally{t.f()}}}]),e}(),gt=n(78),jt=n.n(gt),_t=(b.createLog("Notification"),n.p,n.p+"static/media/pop.5302e13a.mp3"),vt=n.p+"static/media/ringtone.7fb61301.mp3",bt=b.createLog("sound");function Ot(){return(Ot=Object(I.a)(A.a.mark((function e(){var t,n,a,s,i=arguments;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=i.length>0&&void 0!==i[0]?i[0]:{},n=t.repeatInterval,a=new Audio(vt),e.prev=2,!n){e.next=6;break}return s=setInterval((function(){return a.play()}),n),e.abrupt("return",(function(){bt.info("turn off playNotificationSound"),clearInterval(s),a.pause()}));case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),bt.error("Play notification sound failed, reason: ",e.t0&&e.t0.message);case 11:case"end":return e.stop()}}),e,null,[[2,8]])})))).apply(this,arguments)}var yt=function(){var e=Object(I.a)(A.a.mark((function e(){var t;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(t=new Audio(_t)).volume=.2;try{setTimeout((function(){return t.play()}),0)}catch(n){bt.error("Play pop sound failed, reason: ",n&&n.message)}case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),xt="call-history",kt="joiningExistedRoom",Nt="incomingCall",Ct="startingNewCall",St="missingCall",wt=function(){try{var e=JSON.parse(localStorage.getItem(xt));if(e)return{users:e.users,calls:e.calls}}catch(t){localStorage.removeItem(xt)}return{users:[],calls:[]}},Tt=function(){function e(){Object(d.a)(this,e)}return Object(h.a)(e,null,[{key:"get",value:function(){return wt()}},{key:"add",value:function(t){var n=t.startTime,a=t.endTime,s=t.users,i=t.type,r=wt();r.calls.length>=20&&r.calls.splice(0,1),r.calls.push({id:Se(10),startTime:n||+new Date,endTime:a,users:s,type:i}),e.triggerOnAddNewRecord(r.calls),e.updateHistoryUsers(r,s),localStorage.setItem(xt,JSON.stringify(r))}}]),e}();Tt.currentCallId=null,Tt.onAddNewRecord=null,Tt.onHasMissedCall=null,Tt.triggerOnAddNewRecord=function(e){Tt.onAddNewRecord&&"function"==typeof Tt.onAddNewRecord&&Tt.onAddNewRecord(e)},Tt.triggerOnHasMissedCall=function(){Tt.onHasMissedCall&&"function"==typeof Tt.onHasMissedCall&&Tt.onHasMissedCall()},Tt.updateHistoryUsers=function(e,t){t.forEach((function(t){var n=e.users.find((function(e){return e.id==t.id}));n?n.callsNumber+=1:e.users.push(Object(l.a)(Object(l.a)({},t),{},{callsNumber:1}))}))},Tt.getCurrentCall=function(e){return Tt.currentCallId?e.calls.find((function(e){return e.id==Tt.currentCallId})):e.calls[e.calls.length-1]},Tt.addUsersToTheCurrentCall=function(e){var t=Tt.get(),n=Tt.getCurrentCall(t);n&&(n.joinedUsers=e.filter((function(e){return!n.users.find((function(t){return t.id==e.id}))})).map((function(e){return{id:e.id,email:e.email}})),Tt.triggerOnAddNewRecord(t.calls),Tt.updateHistoryUsers(t,n.joinedUsers),localStorage.setItem(xt,JSON.stringify(t)))},Tt.updateTypeOfTheCurrentCall=function(e){var t=Tt.get(),n=Tt.getCurrentCall(t);n&&(n.type=e,Tt.triggerOnAddNewRecord(t.calls),localStorage.setItem(xt,JSON.stringify(t)))},Tt.markAllAsRead=function(){var e=Tt.get();e.calls=e.calls.map((function(e){return Object(l.a)(Object(l.a)({},e),{},{isRead:!0})})),localStorage.setItem(xt,JSON.stringify(e))};var At=Tt,It=n(45),Et=n.n(It),Rt=n.p+"static/media/mic-on-ic.902b97c7.svg",Lt=n.p+"static/media/mic-off-ic.f3bb5eb3.svg",Ut=b.createLog("MicrophoneManager",{logToServer:!0}),Mt=function(e){var t=e.onChange,n=e.agoraClient,a=s.a.useState(n.microphone),i=Object(qe.a)(a,2),r=i[0],c=i[1];return n.onMicrophoneUpdate(c),Object(ue.jsx)("div",{className:ke(Et.a.container,!r&&Et.a.micOff),children:Object(ue.jsxs)("button",{className:Et.a.wrapper,onClick:function(){var e=!r;n.setMicrophone(e),c(e),"function"===typeof t&&t(e),e?(Ut.info("change_microphone_on"),M.trackEvent(Y,[ie.TURN_ON])):(Ut.info("change_microphone_off"),M.trackEvent(Y,[ie.TURN_OFF]))},children:[Object(ue.jsx)("div",{className:Et.a.icon,children:Object(ue.jsx)("img",{src:r?Rt:Lt})}),Object(ue.jsxs)("div",{className:Et.a.label,children:["Mic: ",Object(ue.jsx)("span",{children:r?"ON":"OFF"})]})]})})},Pt=n(13),Bt=n.n(Pt),Ft=n(79),Ht=n.n(Ft),Kt=function(){return Object(ue.jsx)("div",{className:Ht.a.container,children:Object(ue.jsx)("div",{className:Ht.a.loader})})},Dt=n(117),Vt=n.n(Dt),Jt=function(e){var t=e.children,n=e.className,a=e.onClickAsync,i=e.onClick,r=Object(u.a)(e,["children","className","onClickAsync","onClick"]),c=s.a.useState(!1),o=Object(qe.a)(c,2),d=o[0],h=o[1],f=s.a.useRef(null);s.a.useEffect((function(){return function(){console.log("Button unmouted")}}),[]);var m=Object(Ze.debounce)((function(){if("function"!==typeof a)"function"===typeof i&&i();else{var e=a();if(e instanceof Promise){h(!0);Promise.all([new Promise((function(e){setTimeout((function(){return e()}),800)})),e]).finally((function(){f.current&&h(!1)}))}}}),200);return Object(ue.jsx)("button",Object(l.a)(Object(l.a)({className:ke(Vt.a.container,n),onClick:m},r),{},{ref:f,children:d?Object(ue.jsx)(Kt,{}):t}))},Gt=n.p+"static/media/screen-sharing.29688117.svg",Yt=n.p+"static/media/close-ic.d84d13f8.svg",Qt=function(e){var t=e.agoraClient,n=e.disabled,a=(e.isRinging,e.showMessage),i=e.onMicChange,r=s.a.useState(!1),c=Object(qe.a)(r,2),o=c[0],l=c[1],u=s.a.useState(),d=Object(qe.a)(u,2),h=d[0],f=d[1],m=s.a.useState(t.microphone),p=Object(qe.a)(m,2),g=p[0],j=p[1],_=s.a.useState(!1),v=Object(qe.a)(_,2),b=v[0],O=v[1],y=s.a.useRef(),x=function(e){navigator.getUserMedia({audio:!1,video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:e.id}}},(function(e){t.startScreenSharing(e)}),(function(e){console.log("Error when processShareScreenSource",e)}))};s.a.useEffect((function(){t.onSharingScreenStatusChange(l),t.onReceiveVideoTrack((function(e){f(e),e.play(y.current),C(!0)})),t.onRemoveVideoTrack((function(){return f(null)})),t.onMicrophoneUpdate(j),t.onConnectionStateChange((function(e){"DISCONNECTED"===e&&(f(null),l(!1))}))}),[]);var k=function(){var e=Object(I.a)(A.a.mark((function e(){var n,a,s;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,l(n=!o),!n){e.next=9;break}if(M.trackEvent(Q,[ie.TURN_ON]),a=document.getElementById("global-data"),!(s=JSON.parse(a.getAttribute("screen-sources"))).length){e.next=9;break}return e.abrupt("return",x(s[0]));case 9:return M.trackEvent(Q,[ie.TURN_OFF]),e.next=12,t.endScreenSharing();case 12:return e.abrupt("return",e.sent);case 15:e.prev=15,e.t0=e.catch(0),l(!1);case 18:case"end":return e.stop()}}),e,null,[[0,15]])})));return function(){return e.apply(this,arguments)}}(),N=function(){if(!n)return k();a({type:"warning",value:"Please join or start a conversation to share your screen."})},C=function(e){var t=!b;O(t),t?M.trackEvent(q,[ie.OPEN].concat(Object(Qe.a)(e?[]:[ie.AUTO]))):M.trackEvent(q,[ie.CLOSE].concat(Object(Qe.a)(e?[]:[ie.AUTO])))};return Object(ue.jsx)(s.a.Fragment,{children:Object(ue.jsx)("div",{className:ke(Bt.a.container,n&&Bt.a.disabled,h&&Bt.a.hasRemoteTrack),children:Object(ue.jsx)("button",{className:Bt.a.wrapper,onClick:function(){h?b||C():N()},id:"share-screen-button",children:h?Object(ue.jsx)("div",{ref:y,className:ke(Bt.a.video,b&&Bt.a.fullScreen),children:b&&Object(ue.jsxs)("div",{className:Bt.a.controls,children:[Object(ue.jsxs)(Jt,{className:Bt.a.close,onClick:C,children:[Object(ue.jsx)("div",{children:Object(ue.jsx)("img",{src:Yt})}),"Close"]}),Object(ue.jsx)(Jt,{className:Bt.a.mic,onClick:function(){var e=!g;t.setMicrophone(e),j(e),i&&i(e),e?M.trackEvent(W,[ie.TURN_ON]):M.trackEvent(W,[ie.TURN_OFF])},children:g?Object(ue.jsxs)(s.a.Fragment,{children:[Object(ue.jsx)("div",{children:Object(ue.jsx)("img",{src:Rt})}),"Mic: ",Object(ue.jsx)("span",{className:Bt.a.onLabel,children:"ON"})]}):Object(ue.jsxs)(s.a.Fragment,{children:[Object(ue.jsx)("div",{children:Object(ue.jsx)("img",{src:Lt})}),"Mic: ",Object(ue.jsx)("span",{className:Bt.a.offLabel,children:"OFF"})]})})]})}):Object(ue.jsxs)(s.a.Fragment,{children:[Object(ue.jsx)("div",{className:Bt.a.icon,children:Object(ue.jsx)("img",{src:Gt})}),Object(ue.jsx)("div",{className:Bt.a.label,children:o?"Stop sharing":"Share screen"})]})})})})},qt=n(52),Wt=n.n(qt),zt=n.p+"static/media/leave-ic.561f375e.svg",Zt=n(29),Xt=n.n(Zt),$t=n.p+"static/media/speaker-ic.e2e168e2.svg",en=n.p+"static/media/speaker-ic-active.6da08791.svg",tn=function(e){var t=e.name,n=e.id,a=e.agoraUserId,i=e.agoraClient,r=e.auth,c=s.a.useState(n===r.id&&!i.microphone),o=Object(qe.a)(c,2),l=o[0],u=o[1],d=s.a.useState(!1),h=Object(qe.a)(d,2),f=h[0],m=h[1];return s.a.useEffect((function(){i.onMicrophoneUpdate((function(e){n===r.id&&u(!e)}))}),[]),s.a.useEffect((function(){a&&(i.onUserInfoUpdated((function(e){e.agoraUserId===a&&u("muted"===e.status)})),i.onVolumeIndicatorChange((function(e){var t=e.find((function(e){return e.uid===a}));t&&t.level>=3?m(!0):m(!1)})))}),[a]),Object(ue.jsxs)("div",{className:ke(Xt.a.container,f&&Xt.a.isSpeaking,l&&Xt.a.isMuted),children:[Object(ue.jsx)("span",{className:Xt.a.name,children:t}),l?Object(ue.jsx)("span",{className:Xt.a.mic,children:Object(ue.jsx)("img",{src:Lt})}):Object(ue.jsx)("span",{className:Xt.a.mic,children:Object(ue.jsx)("img",{src:f?en:$t})}),!!f&&Object(ue.jsxs)("div",{className:Xt.a.speaking,children:[Object(ue.jsx)("div",{}),Object(ue.jsx)("div",{})]})]})},nn=function(e){var t=e.data,n=e.agoraClient,a=e.showMessage,s=e.auth,i=function(){var e=Object(I.a)(A.a.mark((function e(){var s;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=t&&b.createLog("Room",{logToServer:!0,roomId:t.id}),e.prev=1,n.stop(),e.next=5,S.post("api/room/leave");case 5:a({type:"warning",value:"You left the room."}),s.info("leave_room_success, roomID: ".concat(t.id)),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),a({type:"error",value:"Couldn't leave the room. Please try again."}),s.error("leave_room_failed, room = ".concat(t.id));case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(){return e.apply(this,arguments)}}();return Object(ue.jsxs)("div",{className:Wt.a.container,children:[Object(ue.jsx)("div",{className:Wt.a.users,children:t.users.map((function(e){return Object(ue.jsx)(tn,{name:Ne(e.email),id:e.id,agoraUserId:e.agoraUserId,agoraClient:n,auth:s},e.id)}))}),Object(ue.jsx)("div",{className:Wt.a.action,children:Object(ue.jsxs)(Jt,{onClickAsync:i,className:Wt.a.button,children:[Object(ue.jsx)("img",{src:zt}),"Leave"]})})]})},an=n.p+"static/media/tutorial-ic.15035781.svg",sn=function(e){var t=e.agoraClient,n=e.currentRoom,a=e.showMessage,i=e.auth,r=s.a.useState(!1),c=Object(qe.a)(r,2),o=c[0],l=c[1],u=s.a.useState((function(){})),d=Object(qe.a)(u,2),h=d[0],f=d[1],m=s.a.useState(!1),p=Object(qe.a)(m,2),g=p[0],j=p[1],_=b.createLog("Room",{logToServer:!0}),v=s.a.useRef(),O=n&&n.isGroup,y=g;s.a.useEffect((function(){y=g}),[g]),s.a.useEffect((function(){_=n&&b.createLog("Room",{logToServer:!0,roomId:n.id});var e=v.current;if(e&&n){var s=n.userNames.filter((function(t){return!e.userNames.includes(t)}));s&&s.length&&(_.info("member joins the room",s),a({type:"success",value:"".concat(s.map((function(e){return Ce(e)})).join(", ")," joined the room."),withSound:!0}),At.addUsersToTheCurrentCall(n.users.filter((function(e){return e.id!==i.id}))),1===e.userNames.length&&n.id===e.id&&(_.info("received new call, notify me!"),function(e,t){var n=new Notification(e,{body:t});n&&(n.onclick=function(){window.focus(),n.close()})}("Jam now","".concat(s.join(", ")," want to talk with you")),t.setMicrophone(!1),l(!0),j(!0),function(){return Ot.apply(this,arguments)}({repeatInterval:1500}).then((function(e){return f((function(){return function(){j(!1),e()}}))})),At.add({users:(n.users||[]).filter((function(e){return e.id!==i.id})),type:Nt})));var r=e.userNames.filter((function(e){return!n.userNames.includes(e)}));_.info("member leaves the room",r),r&&r.length&&(a({type:"warning",value:"".concat(r.map((function(e){return Ce(e)})).join(", ")," left the room"),withSound:!0}),1===n.userNames.length&&l(!1),!n.users.filter((function(e){return e.id!==i.id})).length&&y&&(At.updateTypeOfTheCurrentCall(St),At.triggerOnHasMissedCall()))}v.current=n}),[n]);var x=function(){g&&"function"===typeof h&&h()};t.onConnectionStateChange((function(e){"DISCONNECTED"===e&&"function"===typeof h&&h()}));var k=function(e){O&&l(!e)};return Object(ue.jsxs)(s.a.Fragment,{children:[Object(ue.jsxs)("div",{className:jt.a.container,onClick:x,children:[Object(ue.jsx)(Mt,{onChange:k,agoraClient:t,showMessage:a}),Object(ue.jsx)(Qt,{isRinging:g,disabled:!O,agoraClient:t,showMessage:a,onMicChange:k}),O&&n&&!!n.users.length&&Object(ue.jsx)(nn,{agoraClient:t,data:n,showMessage:a,auth:i}),o&&Object(ue.jsxs)("div",{className:jt.a.tutorial,children:[Object(ue.jsx)("img",{src:an}),Object(ue.jsx)("span",{children:"Click to turn Mic on"})]})]}),o&&Object(ue.jsx)("div",{className:"app-overlay",onClick:x})]})},rn=n(60),cn=n.n(rn);var on=function(e){var t=e.auth;return Object(ue.jsxs)("div",{className:cn.a.container,children:[Object(ue.jsx)("div",{className:cn.a.hello,children:"Hello"}),Object(ue.jsx)("div",{className:cn.a.name,children:Ne(t.email)})]})},ln=n(35),un=n.n(ln),dn=n.p+"static/media/search-ic.efdcf548.svg",hn=n(61),fn=n.n(hn),mn=n(62),pn=n.n(mn),gn=function(e){var t=e.onTextChange,n=e.containerClassname,a=e.inputClassname,s=e.appendComponent,i=Object(u.a)(e,["onTextChange","containerClassname","inputClassname","appendComponent"]);return Object(ue.jsxs)("div",{className:ke(pn.a.container,n),children:[Object(ue.jsx)("input",Object(l.a)(Object(l.a)({},i),{},{className:ke(pn.a.input,a),onChange:function(e){return t(e.target.value)},spellCheck:!1})),s&&Object(ue.jsx)("div",{className:pn.a.append,children:s})]})};var jn=function(e){var t=e.keyword,n=e.setKeyword,a=e.containerClassname;return Object(ue.jsx)("div",{className:ke(fn.a.container,a),children:Object(ue.jsx)(gn,{containerClassname:fn.a.input,value:t,onTextChange:n,placeholder:"Search members",appendComponent:Object(ue.jsx)("div",{className:fn.a.append,children:Object(ue.jsx)("img",{src:dn})})})})},_n=n(80),vn=n.n(_n),bn=n(63),On=n.n(bn),yn=n(30),xn=n.n(yn),kn="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAJuSURBVHgBxVdNbtpAFH42fwIEghs4J6hzgiQ3SPegqEvYNN2wbbpkVbKBbSpxgPQETU9QeoL6BiB+BEIC+n0TOzKOHU8ccD4J8aQZz/fNe2/evDFEE+PxuJbJZC5zudzZdru1d7udZRhGjWOwJ7AdmCPTNB9Wq9XPer0+0VnX0CC2QHoN88oj1MTder3+BiGOJBHAHRcKha/Y3bW8ARDdK5VKXyLHJZzcyufzv2Bachg48MZFmDfMEHL7wOSE2tB8PreDA0aA3DoCuR/PPGH4yGsg/3NEcr+IU++UPIWACZcCOWG5XArKA67r/0mKgBdOGArlAZzzG0kZbm0Rw439OO6D4XAos9lMWq1W7Dyi0WhIDCb0ggkll6KJfr8vg8HgxfFut6uEakCV9iyMc53Z3NF0OlUkRNATnrh2ux3rJQ8QcEYBH0QTXNwj84tIQu7CzqJWW6/5IigCd0VScsIyFovFThLAnw8JyRVMeWcwB1gSX3PP78WcIYhKTA1MsljAQR7Yul9EJVxCEQ498Bc/LQFR5FGnQwOjLPq7B5zHq7iZcUfNL6JSqehUQmH/mN1sNvcQ8F1i8qBarUqn05Fmsxk5xxPBvNABm1d1G6J09qDms6SLu3K5/EkJWC6XFkKR6nWMDZ8Ui8XH65gGBNxKSkCIbslJ+11aMrTppzj6+y0ZezS45YIT5HhwyOGR7wkg6Ba45+ORRKi1Pdd7CH2YuEl50IcJdx4kJ0IvI05k63yIxGTCMeZh5ETs45TeQLG6Qdxiq6WPlDH+gQLXiyLWFuBbtIbegf3juTx2UXvPc/zxUhtB7G+U4nt/or2E/ykHP0zvHHI4AAAAAElFTkSuQmCC",Nn=function(e){var t=e.children,n=e.title,a=void 0===n?"":n,s=e.show,i=void 0!==s&&s,r=e.onClose,c=e.closeOnClickBackdrop,o=void 0!==c&&c;return i?Object(ue.jsxs)("div",{className:xn.a.container,children:[Object(ue.jsx)("div",Object(l.a)({className:xn.a.backdrop},o&&r?{onClick:r}:{})),Object(ue.jsxs)("div",{className:xn.a.modal,children:[Object(ue.jsxs)("div",{className:xn.a.headerContainer,children:[r&&Object(ue.jsx)("img",{className:xn.a.closeBtn,src:kn,onClick:r}),Object(ue.jsx)("span",{className:xn.a.title,children:a})]}),Object(ue.jsx)("div",{className:xn.a.content,children:t})]})]}):null},Cn=n(118),Sn=function(e){return Cn.validate(e)},wn=n(81),Tn=n.n(wn),An=function(e){var t=e.text;return Object(ue.jsx)("div",{className:Tn.a.container,children:Object(ue.jsx)("span",{className:Tn.a.text,children:t})})},In=n(36),En=n.n(In);var Rn=function(e){var t=e.emails,n=e.setEmails,a=s.a.useState(""),i=Object(qe.a)(a,2),r=i[0],c=i[1],o=s.a.useState(""),l=Object(qe.a)(o,2),u=l[0],d=l[1],h=function(){return t.includes(r)},f=function(){return Sn(r)},m=function(){return f()&&!h()},p=function(){return""===r},g=function(){return p()?"Please enter your email.":f()?h()?"Email existed.":null:"Please enter a valid email address."};return Object(ue.jsxs)("div",{className:En.a.container,children:[Object(ue.jsxs)("div",{className:En.a.inputEmail,children:[Object(ue.jsx)(gn,{onKeyUp:function(e){13===e.keyCode&&(m()?(n([].concat(Object(Qe.a)(t),[r])),c("")):d(g()))},className:"input ".concat(p()?"":m()?"valid":"invalid"),value:r,onTextChange:function(e){c(String(e||"").toLowerCase()),d("")},placeholder:"Enter an email address"}),Object(ue.jsx)(An,{text:u})]}),Object(ue.jsx)("div",{className:En.a.emailList,children:t.map((function(e){return Object(ue.jsxs)("div",{className:En.a.emailItem,children:[Object(ue.jsx)("span",{className:En.a.email,children:e}),Object(ue.jsx)("img",{src:kn,className:En.a.clearEmailBtn,onClick:function(){return a=e,void n(Object(Qe.a)(t).filter((function(e){return e!==a})));var a}})]},e)}))})]})},Ln=n(82),Un=n.n(Ln);var Mn=function(e){var t=e.onSuccess,n=s.a.useState([]),a=Object(qe.a)(n,2),i=a[0],r=a[1],c=function(e){!0===e&&(r([]),"function"===typeof t&&t())};return Object(ue.jsxs)("div",{className:Un.a.container,children:[Object(ue.jsx)("span",{className:Un.a.desc,children:"Press enter after each address to invite multiple people."}),Object(ue.jsx)(Rn,{emails:i,setEmails:r}),Object(ue.jsx)(Jt,{disabled:0===i.length,onClickAsync:function(){M.trackEvent(ee),i.length>0&&fe.invite(i,c)},children:"Send invitation"})]})},Pn={closeModal:null,showModal:null};function Bn(){Pn.showModal,Pn.showModal()}var Fn=function(){var e=s.a.useState(!1),t=Object(qe.a)(e,2),n=t[0],a=t[1],i=s.a.useState(!1),r=Object(qe.a)(i,2),c=r[0],o=r[1],l=function(){return a(!0)},u=function(){return a(!1)};s.a.useEffect((function(){Pn.closeModal=u,Pn.showModal=l}),[a]);return Object(ue.jsx)(Nn,{show:n,onClose:function(){u(),o(!1)},title:c?"Invitation sent.":"Invite your team.",children:c?Object(ue.jsx)("span",{style:{textAlign:"center"},children:"Your team member will receive the invitation in their email inbox."}):Object(ue.jsx)(Mn,{onSuccess:function(){return o(!0)}})})},Hn=n.p+"static/media/add-user.42a1d98b.svg",Kn=function(){return Object(ue.jsx)("div",{className:On.a.container,onClick:function(){M.trackEvent(Z),Bn()},children:Object(ue.jsxs)("div",{className:On.a.wrapper,children:[Object(ue.jsx)("div",{className:On.a.icon,children:Object(ue.jsx)("img",{src:Hn})}),Object(ue.jsx)("span",{children:"Invite friend"})]})})},Dn=n(24),Vn=n.n(Dn),Jn=(n.p,function(e){var t=e.data;return Object(ue.jsx)("div",{className:Vn.a.userName,children:Ne(t.email)})}),Gn=function(e){var t,n=e.room,a=e.auth,s=e.agoraClient,i=(e.messageQueueManager,e.isCurrentUserTalking,e.showMessage),r=b.createLog("Room",{logToServer:!0,roomId:n.id}),c=n||{},o=c.id,l=c.users,u=a.id,d=l.concat([]).slice(0,3),h=Math.max(l.length-3,0),f=function(){var e=Object(I.a)(A.a.mark((function e(){var t,a,c;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,M.trackEvent(z),r.info("Request join room",o),e.next=5,s.stop();case 5:return e.next=7,S.post("api/room/join",{roomId:o});case 7:return t=e.sent,console.log("Joined room",t,u),a=t.userIds||[],console.log("otherUsers",a),c=a.findIndex((function(e){return e===u})),a.splice(c,1),console.log("otherUsers remove myUserId",a),e.next=16,s.callToRemoteUsers(t.channelName,t.channelToken,a,o);case 16:i({type:"success",value:"You joined the room."}),r.info("join_room_success",o),r.verbose("Joined room, room info: ",t),l.length?At.add({startTime:+new Date,type:kt,users:l}):At.add({startTime:+new Date,type:Ct}),e.next=27;break;case 22:e.prev=22,e.t0=e.catch(0),S.post("api/room/leave"),r.critical("join_room_failed, room = ".concat(n.id,", reason: ").concat(e.t0.message)),i({type:"error",value:"Couldn't join the room. Please try again."});case 27:case"end":return e.stop()}}),e,null,[[0,22]])})));return function(){return e.apply(this,arguments)}}();return o?Object(ue.jsx)("div",{className:Vn.a.container,children:Object(ue.jsxs)("div",{className:Vn.a.wrapper,children:[(t=n,t.userIds.length>1&&Object(ue.jsxs)("div",{className:Vn.a.talking,children:[Object(ue.jsxs)("span",{className:Vn.a.talkingAnimation,children:[Object(ue.jsx)("span",{}),Object(ue.jsx)("span",{}),Object(ue.jsx)("span",{})]}),Object(ue.jsx)("span",{children:"Talking"})]})),Object(ue.jsxs)("div",{className:Vn.a.users,children:[d.map((function(e,t){return Object(ue.jsx)(Jn,{data:e},e.id||t)})),!!h&&Object(ue.jsxs)("div",{className:Vn.a.remainingUsers,children:["+",h," other(s)"]})]}),Object(ue.jsx)("div",{className:Vn.a.actions,children:Object(ue.jsx)(Jt,{className:Vn.a.button,onClickAsync:f,children:"Join"})})]})}):null},Yn=n(64),Qn=n.n(Yn),qn=function(e){var t=e.className,n=e.text,a=void 0===n?"There isn\u2019t anyone else here at the moment.":n,s=e.inviteText;return Object(ue.jsx)("div",{className:ke(Qn.a.container,t),children:Object(ue.jsxs)("span",{className:Qn.a.desc,children:[a,Object(ue.jsx)("span",{className:Qn.a.inviteLink,onClick:function(){M.trackEvent($,[{key:"custom_explain_text",value:a}]),Bn()},children:s})]})})},Wn=function(e){var t=e.listRoom,n=e.auth,a=e.agoraClient,s=e.keyword,i=void 0===s?"":s,r=e.messageQueueManager,c=e.showMessage,o=Object(Qe.a)(t.filter((function(e){return!e.isYourRoom&&e&&e.search.includes(i)})));return o.length?Object(ue.jsxs)("div",{className:vn.a.container,children:[Object(ue.jsx)(Kn,{}),o.map((function(e){return(null===e||void 0===e?void 0:e.isGroup)&&(null===e||void 0===e?void 0:e.isYourRoom)?null:Object(ue.jsx)(Gn,{messageQueueManager:r,showMessage:c,room:Object(l.a)({},e),auth:n,agoraClient:a},e.id)}))]}):Object(ue.jsx)(qn,{className:vn.a.noRoom,text:i?"The person you\u2019re looking for isn\u2019t on Jam right now.":"There isn\u2019t anyone else here at the moment.",inviteText:i?"Invite them.":"Invite your team."})};var zn=function(e){var t=e.listRoom,n=e.auth,a=e.agoraClient,s=e.keyword,i=e.messageQueueManager,r=e.onSearchKeyword,c=e.showMessage;return Object(ue.jsxs)("div",{className:un.a.container,children:[Object(ue.jsxs)("div",{className:un.a.headerBar,children:[Object(ue.jsx)("span",{className:ke(un.a.left,un.a.title),children:"Your team"}),Object(ue.jsx)("div",{className:un.a.right,children:Object(ue.jsx)(jn,{setKeyword:r,keyword:s,containerClassname:un.a.searchBox})})]}),Object(ue.jsx)(Wn,{listRoom:t,auth:n,agoraClient:a,keyword:s,messageQueueManager:i,showMessage:c})]})},Zn=(b.createLog("TrollBox Socket"),"firstData"),Xn="updateData",$n=new(function(e){Object(nt.a)(n,e);var t=Object(at.a)(n);function n(){var e;return Object(d.a)(this,n),(e=t.call(this,"trollbox",v.SOCKET_SERVER,v.SOCKET_SERVER_PATH)).events={},e.auth=null,e}return Object(h.a)(n,[{key:"init",value:function(e){this.auth=e,this.listen()}},{key:"sendMessage",value:function(e){this.socket.emit("postMessage",{message:e})}},{key:"onFirstData",value:function(e){this.events[Zn]=e}},{key:"onUpdateData",value:function(e){this.events[Xn]=e}},{key:"listen",value:function(){var e=this;this.socket.on(this.auth.id,(function(t){t&&"last100messages"===t.command&&t.status&&(console.log(t,"last100messages"),e._callEvent(Zn,t.data||[]))})),this.socket.on("broadcast",(function(t){console.log(t,"broadcast"),t&&"newMessage"===t.command&&t.status&&e._callEvent(Xn,t.data)}))}}]),n}(rt)),ea=n(57),ta=n(25),na=n.n(ta),aa=function e(){Object(d.a)(this,e)};aa.notificationGoneTimeoutHandler=null,aa.notificationHidingTimeoutHandler=null,aa.notificationIntervalHandler=null,aa.initialMessage={type:"",value:""},aa.activeMessage=null,aa.messages=[],aa.clearTimeoutHandlers=function(){clearTimeout(aa.notificationGoneTimeoutHandler),clearTimeout(aa.notificationHidingTimeoutHandler)},aa.clearIntervalHandlers=function(){clearInterval(aa.notificationIntervalHandler)},aa.getTheFirstMessageInQueue=function(){return aa.messages.splice(0,1)[0]};var sa=aa,ia=n.p+"static/media/trollboxsendbutton.74c120bb.svg",ra=[];var ca=function(){var e=s.a.useState(""),t=Object(qe.a)(e,2),n=t[0],a=t[1],i=s.a.useState([]),r=Object(qe.a)(i,2),c=r[0],o=r[1],l=s.a.useRef(null);s.a.useEffect((function(){$n.onFirstData((function(e){o(e),ra=e,u()})),$n.onUpdateData(d)}),[]);var u=function(){l&&l.current&&l.current.scrollToBottom()},d=function(e){ra=[].concat(Object(Qe.a)(ra),[e]),o(ra),u()},h=function(){$n.sendMessage(n),a("")};return Object(ue.jsxs)("div",{className:na.a.container,id:"troll-box",children:[Object(ue.jsx)("div",{className:na.a.messageWrapper,children:Object(ue.jsx)("div",{id:"data",className:na.a.messageContainer,children:Object(ue.jsx)(ea.Scrollbars,{style:{height:383},ref:l,children:c.map((function(e){return e?Object(ue.jsxs)("div",{className:na.a.messageContainerSingle,children:[Object(ue.jsxs)("div",{className:na.a.senderName,children:[" ",e.email.split("@")[0],":"]}),Object(ue.jsx)("div",{className:na.a.message,children:e.message})]},e.create_at):null}))})})}),Object(ue.jsxs)("div",{className:na.a.inputContainer,children:[Object(ue.jsx)("input",{onKeyPress:function(e){13===e.which&&h()},value:n,onChange:function(e){a(e.target.value)},placeholder:"Say something...",className:na.a.inputField,spellCheck:!1}),Object(ue.jsx)("button",{onClick:h,className:na.a.submitMessage,children:Object(ue.jsx)("img",{src:ia})})]})]})},oa=b.createLog("Main");M.trackPage(oe);var la=function(e){oa.info("main page renderer",(new Date).getTime());var t=e.showMessage,n=fe.auth,i=s.a.useState([]),r=Object(qe.a)(i,2),c=r[0],o=r[1],u=s.a.useState(""),d=Object(qe.a)(u,2),h=d[0],f=d[1],m=s.a.useState(null),p=Object(qe.a)(m,2),g=p[0],j=p[1],_=s.a.useState(),v=Object(qe.a)(_,2),b=v[0],O=v[1],y=function(e){var t=Object.values(e),a=n.id;oa.info("current user id",a),oa.verbose("receive rooms from server",Object(Qe.a)(t));var s=t.map((function(e){return Object(l.a)(Object(l.a)({},e),{},{isYourRoom:e.userIds.includes(n.id),isYourOneMemberRoom:e.isYourRoom&&1===e.userIds.length,isTwoMembersRoom:2===e.userIds.length,isGroup:e.userIds.length>1,isPersonalCall:e.isYourRoom&&e.isTwoMembersRoom,userEmails:e.users.map((function(e){return e.email})),userNames:e.users.map((function(e){return Ne(e.email)})),search:e.users.map((function(e){return e.email})).join(", "),users:e.users.map((function(t){return Object(l.a)(Object(l.a)({},t),{},{agoraUserId:((e.agoraInfo||[]).find((function(e){return e.userId==t.id}))||{}).agoraUserId})}))})}));(oa.verbose("rooms change ",s),s.length>0)&&(s.find((function(e){return e.userIds.includes(n.id)&&1===e.userIds.length}))&&(oa.info("You are not in any group."),oa.info("Close any opened connection."),g.stop()));O(s.find((function(e){return e.userIds.includes(n.id)}))),o(s)};if(Object(a.useEffect)((function(){return oa.info("init socket"),lt.init(n),dt.init(n),$n.init(n),j(new tt(n.id,dt.socket)),oa.info("on list room"),lt.onListRoom(y),function(){}}),[]),Object(a.useEffect)((function(){oa.info("update on list room agoraClient"),lt.onListRoom(y)}),[g]),void 0===n||!g)return null;var x=new pt;return x?Object(ue.jsxs)("div",{className:ft.a.container,children:[Object(ue.jsx)(on,{auth:n}),Object(ue.jsx)(sn,{agoraClient:g,currentRoom:b,auth:n,showMessage:t}),Object(ue.jsx)(zn,{listRoom:c,auth:n,agoraClient:g,keyword:h,messageQueueManager:x,onSearchKeyword:f,showMessage:t}),Object(ue.jsx)(ca,{})]}):null},ua=n(119),da=n.n(ua);var ha=function(e){var t=e.onTimeout,n=e.timeoutSecond,i=s.a.useState(parseInt(n,10)),r=Object(qe.a)(i,2),c=r[0],o=r[1],l=function(){return o(c-1)};return Object(a.useEffect)((function(){if(0!==c){var e=setInterval(l,1e3);return function(){return clearInterval(e)}}t()}),[c]),Object(ue.jsxs)(ue.Fragment,{children:[c,"s"]})},fa=n(31),ma=n.n(fa),pa=b.createLog("OTP");var ga=function(e){e.email;var t=e.otp,n=e.setOtp,a=e.enableResend,s=e.setResendStatus,i=e.onClickResend,r=e.onLogin;return Object(ue.jsxs)("div",{className:ma.a.container,children:[Object(ue.jsx)("p",{className:ma.a.annouce,children:"Enter the Jam code sent to your email inbox."}),Object(ue.jsx)(da.a,{containerStyle:ma.a.otpInput,inputStyle:ma.a.inputCell,isInputNum:!0,shouldAutoFocus:!0,value:t,onChange:function(e){n(e)},numInputs:6,separator:Object(ue.jsx)("span",{})}),Object(ue.jsxs)("div",{className:ma.a.resendContainer,children:["Didn\u2019t get the code?",a?Object(ue.jsx)("span",{className:ma.a.resendBtn,onClick:function(){M.trackEvent(K),i()},children:"Resend"}):Object(ue.jsxs)("span",{className:ma.a.resendCountdown,children:["Resend in ",Object(ue.jsx)(ha,{timeoutSecond:30,onTimeout:function(){return s(!0)}})]})]}),Object(ue.jsx)(Jt,{className:"button submit ".concat(6!==t.length?"disabled":""),type:"submit",onClick:function(){M.trackEvent(H),6===t.length&&(pa.info("send otp to login",t),r(t))},children:"Login"})]})},ja=n(37),_a=n.n(ja),va=b.createLog("Login");function ba(){var e=s.a.useState(""),t=Object(qe.a)(e,2),n=t[0],a=t[1],i=s.a.useState(""),r=Object(qe.a)(i,2),c=r[0],o=r[1],l=s.a.useState(!1),u=Object(qe.a)(l,2),d=u[0],h=u[1],f=s.a.useState(""),m=Object(qe.a)(f,2),p=m[0],g=m[1],j=s.a.useState(!1),_=Object(qe.a)(j,2),v=_[0],b=_[1],O=Object(w.g)(),y=function(e){va.info("Login result received",e),setTimeout((function(){O.push("/")}),200)};var x=function(){return""===n},k=function(){return!x()&&!Sn(n)},N=function(e){va.info("on request otp success. Result: ",e),!0===e&&h(!0)},C=function(){(x()?(o("Please enter your work email."),0):!k()||(o("Please enter a valid email address."),0))&&fe.requestOtp(n,N)},S=function(e){va.info("on resend otp success",e)};return Object(ue.jsx)("div",{className:_a.a.container,children:d?Object(ue.jsx)(ga,{email:n,otp:p,setOtp:g,enableResend:v,setResendStatus:b,onClickResend:function(){b(!1),fe.resendOtp(n,S)},onLogin:function(e){va.info("request login with new code. "+e),fe.verifyOtp(p,y)}}):Object(ue.jsxs)("div",{className:_a.a.form,children:[Object(ue.jsx)("h3",{className:_a.a.loginTitle,children:"Welcome to JAM"}),Object(ue.jsxs)("div",{className:_a.a.inputContainer,children:[Object(ue.jsx)(gn,{className:_a.a.input,type:"text",placeholder:"Enter your work email",maxLength:100,value:n,onTextChange:function(e){a(String(e||"").toLowerCase()),o("")},onKeyUp:function(e){13===e.keyCode&&(M.trackEvent(F,[ie.PRESS_ENTER]),C())},onFocus:function(){return M.trackEvent(D)}}),!!c.length&&Object(ue.jsx)(An,{text:c})]}),Object(ue.jsx)(Jt,{className:_a.a.submitButton,onClick:function(){M.trackEvent(F),C()},children:"Continue"})]})})}M.trackPage(le);var Oa=function(){return Object(ue.jsx)(ba,{})},ya=n(120),xa=n.n(ya),ka=function(e){var t=e.onTextChange,n=e.className,a=Object(u.a)(e,["onTextChange","className"]);return Object(ue.jsx)("textarea",Object(l.a)(Object(l.a)({maxLength:1e3},a),{},{className:ke(xa.a.container,n),onChange:function(e){return t(e.target.value)}}))},Na=n(65),Ca=n.n(Na),Sa=function(e){var t=e.onSuccess,n=s.a.useState(""),a=Object(qe.a)(n,2),i=a[0],r=a[1],c=s.a.useState(!0),o=Object(qe.a)(c,2),l=o[0],u=o[1],d=fe.auth.email,h=navigator&&navigator.userAgent,f=function(){u("Sorry, can not send your feedback, please try again")};return Object(ue.jsxs)("div",{className:Ca.a.container,children:[Object(ue.jsxs)("div",{className:Ca.a.contentContainer,children:[Object(ue.jsx)(ka,{onTextChange:function(e){r(e),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";try{return e.split(/[\n, ]/g).filter(Boolean).length}catch(t){return e.length}}(e)<3?u("The feedback is too short"):u("")},value:i,className:Ca.a.textarea,placeholder:"Share your thoughts here."}),Object(ue.jsx)(An,{text:l})]}),Object(ue.jsx)(Jt,{disabled:l,onClickAsync:function(){return M.trackEvent(ne),S.post("api/send-feedback",{email:d,content:i,other:h}).then(t).catch(f)},children:"Submit"})]})},wa={closeModal:null,showModal:null};function Ta(){wa.showModal,wa.showModal()}var Aa=function(){var e=s.a.useState(!1),t=Object(qe.a)(e,2),n=t[0],a=t[1],i=s.a.useState(!1),r=Object(qe.a)(i,2),c=r[0],o=r[1],l=function(){return a(!0)},u=function(){return a(!1)};s.a.useEffect((function(){wa.closeModal=u,wa.showModal=l}),[]);return Object(ue.jsx)(Nn,{show:n,onClose:function(){u(),o(!1)},title:c?"Thanks for sharing your thoughts.":"How would you improve JAM?",children:c?Object(ue.jsx)("span",{style:{textAlign:"center"},children:"Your feedback will be super helpful. Thanks for using Jam!"}):Object(ue.jsx)(Sa,{onSuccess:function(){return o(!0)}})})},Ia=n(11),Ea=n.n(Ia),Ra=n(83),La=n.n(Ra),Ua=n(38),Ma=n.n(Ua),Pa=function(e){return e<10?"0".concat(e):e},Ba=function(e){var t=new Date(e);return"".concat(t.getFullYear(),"/").concat(Pa(t.getMonth()+1),"/").concat(Pa(t.getDate()),"\n\t\t\t").concat(Pa(t.getHours()),":").concat(Pa(t.getMinutes()),"\n\t")},Fa=function(e){var t=e.type,n=e.users,a=e.startTime,s=(e.endTime,e.joinedUsers),i=e.isRead;return Object(ue.jsxs)("div",{className:ke(Ma.a.container,i&&Ma.a.isRead),children:[Object(ue.jsxs)("div",{className:Ma.a.message,children:[function(){switch(t){case kt:return Object(ue.jsxs)("span",{children:["You ",Object(ue.jsx)("span",{className:Ma.a.joining,children:"joined"})," room with"]});case Nt:return Object(ue.jsx)("span",{children:"You received a call from"});case St:return Object(ue.jsxs)("span",{children:["You ",Object(ue.jsx)("span",{className:Ma.a.missing,children:"missed"})," a call from"]});default:return Object(ue.jsx)("span",{children:"You called with"})}}()," ",!!n.length&&function(){var e=n.concat(s||[]);return 1==e.length?Object(ue.jsx)("b",{children:Ce(Ne(e[0].email))}):2==e.length?Object(ue.jsxs)(ue.Fragment,{children:[Object(ue.jsx)("b",{children:Ce(Ne(e[0].email))})," and ",Object(ue.jsx)("b",{children:Ce(Ne(e[1].email))})]}):Object(ue.jsxs)(ue.Fragment,{children:[Object(ue.jsx)("b",{children:Ce(Ne(e[0].email))}),", ",Object(ue.jsx)("b",{children:Ce(Ne(e[1].email))})," and ",Object(ue.jsxs)("b",{children:[e.length-2," other(s)"]})]})}(),"."]}),Object(ue.jsx)("div",{className:Ma.a.time,children:Ba(a)})]})},Ha=function(){var e=s.a.useState(At.get().calls),t=Object(qe.a)(e,2),n=t[0],a=t[1];return s.a.useEffect((function(){At.onAddNewRecord=a,At.markAllAsRead()}),[]),Object(ue.jsx)("div",{className:La.a.container,children:Object(ue.jsx)(ea.Scrollbars,{className:"activities-scrollbar",style:{width:280,maxHeight:"480px"},children:n.length?n.concat([]).reverse().map((function(e){return Object(ue.jsx)(Fa,Object(l.a)({},Object(l.a)(Object(l.a)({},e),{},{key:"".concat(e.startTime,"-").concat(e.endTime)})))})):Object(ue.jsx)("div",{className:La.a.empty,children:" There's no activity at the moment."})})})},Ka=n.p+"static/media/pulse.9a71fa96.svg",Da=n.p+"static/media/bell-ic.fadacd03.svg";var Va,Ja=function(){var e=s.a.useState(!1),t=Object(qe.a)(e,2),n=t[0],a=t[1],i=s.a.useState(!1),r=Object(qe.a)(i,2),c=r[0],o=r[1],l=s.a.useState(fe.auth),u=Object(qe.a)(l,2),d=u[0],h=u[1],f=Object(w.g)(),m=s.a.useRef(null),p=s.a.useRef(null),g=s.a.useRef(null),j=s.a.useRef(null);s.a.useEffect((function(){At.onHasMissedCall=function(){o(!0)},fe.onAuthChange(h);var e=function(e){p.current&&p.current.contains(e.target)?console.log("Clicked inside menu"):a(!1),g.current&&g.current.contains(e.target)||j.current&&j.current.contains(e.target)?console.log("Clicked inside activities"):o(!1)};return window.addEventListener("click",e),function(){window.removeEventListener("click",e)}}),[]);var _=function(){a(!n)};return Object(ue.jsxs)("div",{className:ke(Ea.a.container,d&&d.workspace&&Ea.a.hasWorkspace),children:[Object(ue.jsxs)("div",{className:Ea.a.title,onClick:function(){return f.push("/")},children:["JAM",Object(ue.jsx)("img",{src:Ka,className:Ea.a.icon}),d&&d.workspace&&Object(ue.jsx)("span",{className:Ea.a.workspace,children:d.workspace})]}),d?Object(ue.jsxs)("div",{className:Ea.a.actions,children:[Object(ue.jsx)("button",{className:Ea.a.feedbackButton,onClick:function(){return M.trackEvent(te),Ta()},children:"Send feedback"}),Object(ue.jsx)("div",{className:Ea.a.activities,ref:g,children:Object(ue.jsx)("button",{onClick:function(){o(!c)},children:Object(ue.jsx)("img",{src:Da})})}),c&&Object(ue.jsx)("div",{ref:j,children:Object(ue.jsx)(Ha,{})}),Object(ue.jsxs)("button",{className:Ea.a.hamburger,onClick:function(){return M.trackEvent(se),_()},ref:p,children:[Object(ue.jsx)("div",{className:Ea.a.line}),Object(ue.jsx)("div",{className:Ea.a.line}),Object(ue.jsx)("div",{className:Ea.a.line})]}),n?Object(ue.jsxs)("div",{className:Ea.a.menu,ref:m,children:[Object(ue.jsx)("div",{className:Ea.a.item,onClick:function(){M.trackEvent(X),Bn()},children:"Invite your team"}),Object(ue.jsx)("div",{className:Ea.a.item,onClick:function(){return M.trackEvent(te),Ta()},children:"Send feedback"}),Object(ue.jsx)("div",{className:Ea.a.item,onClick:function(){M.trackEvent(ae),fe.logout()},children:"Log out"})]}):""]}):""]})},Ga=n(46),Ya=n.n(Ga),Qa=function(e){var t=e.type,n=e.message,a=e.shown,s=e.hiding;return Object(ue.jsx)("div",{className:ke(Ya.a.container,s&&Ya.a.hiding,a&&Ya.a.shown),children:Object(ue.jsx)("div",{className:ke(Ya.a.wrapper,Ya.a[t]),children:n})})},qa=function(e){return function(t){return s.a.useEffect((function(){console.log("Load scripts..."),function(){if("undefined"!=typeof window&&v.GA_CONFIG&&v.GA_CONFIG.trackingId){var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=".concat(v.GA_CONFIG.trackingId);var t=document.createElement("script");t.innerHTML="\n\t\t\twindow.dataLayer = window.dataLayer || [];\n\t\t\tfunction gtag(){dataLayer.push(arguments);}\n\t\t\tgtag('js', new Date());\n\t\t\tgtag('config', '".concat(v.GA_CONFIG.trackingId,"');\n\t\t");var n=document.getElementsByTagName("head")[0];n.appendChild(e),e.onload=function(){n.appendChild(t)}}}()}),[]),Object(ue.jsx)(e,Object(l.a)({},t))}}((Va=function(e){var t=e.message,n=e.showMessage;return Object(ue.jsx)("div",{className:o.a.container,children:Object(ue.jsxs)(ge.a,{children:[Object(ue.jsx)(Ja,{authService:fe}),Object(ue.jsx)(Qa,{type:t.type,message:t.value,shown:t.shown,hiding:t.hiding}),Object(ue.jsxs)("div",{className:o.a.appContainer,children:[Object(ue.jsx)(Aa,{}),Object(ue.jsx)(Fn,{}),Object(ue.jsx)(y.ToastsContainer,{store:y.ToastsStore,position:y.ToastsContainerPosition.TOP_RIGHT}),Object(ue.jsxs)(w.d,{children:[Object(ue.jsx)(me,{exact:!0,path:"/",children:Object(ue.jsx)(la,{showMessage:n})}),Object(ue.jsx)(pe,{path:"/login",children:Object(ue.jsx)(Oa,{})}),Object(ue.jsx)(w.b,{path:"/get-started",children:Object(ue.jsx)(Ye,{})})]})]})]})})},function(e){var t=s.a.useState(Object(l.a)(Object(l.a)({},sa.initialMessage),{},{shown:!1,hiding:!1})),n=Object(qe.a)(t,2),a=n[0],i=n[1],r=function(){sa.messages.length?(sa.activeMessage=sa.getTheFirstMessageInQueue(),sa.activeMessage.withSound&&yt(),i(Object(l.a)(Object(l.a)({},sa.activeMessage),{},{shown:!0,hiding:!1})),sa.isShowingMessage=!0):(sa.clearIntervalHandlers(),sa.notificationHidingTimeoutHandler=setTimeout((function(){i(Object(l.a)(Object(l.a)({},sa.activeMessage),{},{shown:!0,hiding:!0})),sa.notificationGoneTimeoutHandler=setTimeout((function(){i(Object(l.a)(Object(l.a)({},sa.activeMessage),{},{value:"",shown:!1,hiding:!1})),sa.activeMessage=null}),200)}),3e3))};return Object(ue.jsx)(Va,Object(l.a)({},Object(l.a)(Object(l.a)({},e),{},{message:a,showMessage:function(e){var t=e.type,n=e.value,s=e.withSound;sa.clearIntervalHandlers(),sa.clearTimeoutHandlers(),a.type===t&&a.value===n||(sa.messages.length>2&&sa.messages.splice(sa.messages.length-1,1),sa.messages.push({type:t,value:n,withSound:s})),sa.activeMessage||r(),sa.notificationIntervalHandler=setInterval((function(){r()}),1500)}})))})),Wa=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,200)).then((function(t){var n=t.getCLS,a=t.getFID,s=t.getFCP,i=t.getLCP,r=t.getTTFB;n(e),a(e),s(e),i(e),r(e)}))},za=b.createLog("Index file");za.info("App is runing on mode:",v.IS_PRODUCTION?"production 123":"development"),za.info("App version:",v.VERSION),M.setup(),r.a.render(Object(ue.jsx)(s.a.StrictMode,{children:Object(ue.jsx)(qa,{})}),document.getElementById("root")),Wa()},24:function(e,t,n){e.exports={container:"styles_container__APTgC",wrapper:"styles_wrapper__2dFAo",talking:"styles_talking__Z5kIZ",talkingAnimation:"styles_talkingAnimation__5YKS7",upAndDown:"styles_upAndDown__1IZSz",users:"styles_users__3gdRJ",userName:"styles_userName__gokpT",remainingUsers:"styles_remainingUsers__3nyjg",actions:"styles_actions__2RVKb",button:"styles_button__3Kinw",fadeIn:"styles_fadeIn__2sZze",fadeOut:"styles_fadeOut__1PK8y"}},25:function(e,t,n){e.exports={container:"styles_container__yFNoJ",messageWrapper:"styles_messageWrapper__1TQgp",messageContainer:"styles_messageContainer__2NZXU",messageContainerSingle:"styles_messageContainerSingle__3j54f",senderName:"styles_senderName__1WJZD",message:"styles_message__3aAKj",inputContainer:"styles_inputContainer__1diS3",submitMessage:"styles_submitMessage__1SHKk",inputField:"styles_inputField__zkLtH"}},29:function(e,t,n){e.exports={container:"styles_container___Z3sm",isSpeaking:"styles_isSpeaking__2b8uj",mic:"styles_mic__1lkLN",isMuted:"styles_isMuted__Avq69",name:"styles_name__3cTuJ",speaking:"styles_speaking__2TCRx",pulse1:"styles_pulse1___mH_Q",pulse2:"styles_pulse2__m8AK6"}},30:function(e,t,n){e.exports={container:"styles_container__1Ken0",backdrop:"styles_backdrop__12n1F",modal:"styles_modal__3LbiY",headerContainer:"styles_headerContainer__3Oo4Z",title:"styles_title__SASG2",closeBtn:"styles_closeBtn__7Hpzb",content:"styles_content__1wvHn"}},31:function(e,t,n){e.exports={container:"styles_container__2vqIY",annouce:"styles_annouce__13EgD",otpInput:"styles_otpInput__1NXEV",inputCell:"styles_inputCell__34iu2",resendContainer:"styles_resendContainer__15PSP",resendBtn:"styles_resendBtn__1lOHz",resendCountdown:"styles_resendCountdown__2VaKN"}},34:function(e,t,n){e.exports={container:"styles_container__190_R",wrapper:"styles_wrapper__3Hsgi",mainImage:"styles_mainImage__1ZSP7",mobile:"styles_mobile__fVCQt",desk:"styles_desk__Un0Su"}},35:function(e,t,n){e.exports={container:"styles_container__258lj",headerBar:"styles_headerBar__3EV3e",right:"styles_right__1yYsk",left:"styles_left__3I84A",searchBox:"styles_searchBox__jtRRp",invite:"styles_invite__2t27C"}},36:function(e,t,n){e.exports={container:"styles_container__30gyY",inputEmail:"styles_inputEmail__3CLI0",addBtn:"styles_addBtn__3WJ0l",emailList:"styles_emailList__1oHel",emailItem:"styles_emailItem__1X_PI",email:"styles_email__3WF7P",clearEmailBtn:"styles_clearEmailBtn__3p2YR"}},37:function(e,t,n){e.exports={container:"styles_container__1ue48",form:"styles_form__PNMni",inputContainer:"styles_inputContainer__39SmI",submitButton:"styles_submitButton__3GBd4",loginTitle:"styles_loginTitle__1C1ye"}},38:function(e,t,n){e.exports={container:"styles_container__29AsA",isRead:"styles_isRead__3dcY9",message:"styles_message__aYhkQ",missing:"styles_missing__2uOw1",joining:"styles_joining__3Jr5U",time:"styles_time__3638F",name:"styles_name__1e36w"}},44:function(e,t,n){e.exports={container:"styles_container___3-Jo",wrapper:"styles_wrapper__pDNQS",title:"styles_title__3NY_j",description:"styles_description__1zlPK",actions:"styles_actions__2TQqe"}},45:function(e,t,n){e.exports={container:"styles_container__BgyV7",wrapper:"styles_wrapper__1PxYW",icon:"styles_icon__3mh-z",label:"styles_label__XV5tt",micOff:"styles_micOff__4n2nV"}},46:function(e,t,n){e.exports={container:"styles_container__1BkX7",shown:"styles_shown__3vMmG",fadeIn:"styles_fadeIn__2sYkT",hiding:"styles_hiding__3S_ey",fadeOut:"styles_fadeOut__1mnOL",wrapper:"styles_wrapper__bNuwp",success:"styles_success__I1hLo",error:"styles_error__1WYJi",warning:"styles_warning__1oMJi",upAndDown:"styles_upAndDown__2DoLm"}},51:function(e,t,n){e.exports={container:"styles_container__2WOut",icon:"styles_icon__3XwCv",title:"styles_title__3hKG4",description:"styles_description__2cbAg"}},52:function(e,t,n){e.exports={container:"styles_container__3saYk",users:"styles_users__3BS-f",action:"styles_action__1aXfR",button:"styles_button__2R28y"}},58:function(e,t,n){e.exports={container:"styles_container__ttgLw",fullWidth:"styles_fullWidth__39sy6"}},59:function(e,t,n){e.exports={container:"styles_container__2v12R",title:"styles_title__3WmO7",action:"styles_action__2aVo0"}},60:function(e,t,n){e.exports={container:"styles_container__dPyc1",hello:"styles_hello__2wCMj",name:"styles_name__yILLb"}},61:function(e,t,n){e.exports={container:"styles_container__27o-r",input:"styles_input__ZOqoE",append:"styles_append__2nFxc"}},62:function(e,t,n){e.exports={container:"styles_container__30PM3",input:"styles_input__2hQnB",append:"styles_append__3Bdx7"}},63:function(e,t,n){e.exports={container:"styles_container__2vT8m",wrapper:"styles_wrapper__2f_WL",icon:"styles_icon__2nxkR"}},64:function(e,t,n){e.exports={container:"styles_container__3BZXA",desc:"styles_desc__2RS3r",inviteLink:"styles_inviteLink__Hd-cl"}},65:function(e,t,n){e.exports={container:"styles_container__1RfIw",contentContainer:"styles_contentContainer__1353V",textarea:"styles_textarea__pyLnp"}},73:function(e,t,n){e.exports={appContainer:"App_appContainer__1hNk1"}},76:function(e,t,n){e.exports={container:"styles_container__3r-5T",wrapper:"styles_wrapper__2KXN9"}},77:function(e,t,n){e.exports={container:"styles_container__HCHsW",copyright:"styles_copyright__1vf4Q"}},78:function(e,t,n){e.exports={container:"styles_container__3SnZE",tutorial:"styles_tutorial__WGiEM"}},79:function(e,t,n){e.exports={container:"styles_container__1lhW0",loader:"styles_loader__1rTYe",load7:"styles_load7__31Ju9"}},80:function(e,t,n){e.exports={container:"styles_container__3nNFz",noRoom:"styles_noRoom__3px2z"}},81:function(e,t,n){e.exports={container:"styles_container__1g9Sd",text:"styles_text__1GP7y"}},82:function(e,t,n){e.exports={container:"styles_container__2nMVv",desc:"styles_desc__1sELS"}},83:function(e,t,n){e.exports={container:"styles_container__AiTEL",empty:"styles_empty__308q5"}}},[[199,1,2]]]);
//# sourceMappingURL=main.52ef73ba.chunk.js.map