(this.webpackJsonpjamfrontend=this.webpackJsonpjamfrontend||[]).push([[0],{11:function(e,t,n){e.exports={container:"styles_container__27zPF",hasWorkspace:"styles_hasWorkspace__35bpu",title:"styles_title__2N76P",icon:"styles_icon__1HAua",workspace:"styles_workspace__3ElHp",hamburger:"styles_hamburger__Many8",line:"styles_line__2quYi",menu:"styles_menu__U4OyW",item:"styles_item__2yL_F",activities:"styles_activities__3XMLR",feedbackButton:"styles_feedbackButton__3p7oD",actions:"styles_actions__103cl"}},119:function(e,t,n){e.exports={container:"styles_container__HZ07f"}},121:function(e,t,n){e.exports={container:"styles_container__3IYSa"}},124:function(e,t,n){e.exports={container:"styles_container__d6Ncq"}},13:function(e,t,n){e.exports={container:"styles_container__2ceuK",disabled:"styles_disabled__10k6G",label:"styles_label__1gj-5",wrapper:"styles_wrapper__Qginb",icon:"styles_icon__3V-2s",hasRemoteTrack:"styles_hasRemoteTrack__1oJ2g",video:"styles_video__3ct2I",fullScreen:"styles_fullScreen__2lRL9",controls:"styles_controls__2cyTN",close:"styles_close__123BB",mic:"styles_mic__1KuzU",offLabel:"styles_offLabel__2jPEe",onLabel:"styles_onLabel__uuFb9"}},131:function(e,t,n){},132:function(e,t,n){},14:function(e,t,n){e.exports={container:"styles_container__APTgC",wrapper:"styles_wrapper__2dFAo",roomStatusContainer:"styles_roomStatusContainer__1teUR",talking:"styles_talking__Z5kIZ",talkingAnimation:"styles_talkingAnimation__5YKS7",upAndDown:"styles_upAndDown__1IZSz",locking:"styles_locking__taSW3",users:"styles_users__3gdRJ",userName:"styles_userName__gokpT",remainingUsers:"styles_remainingUsers__3nyjg",actions:"styles_actions__2RVKb",button:"styles_button__3Kinw",join:"styles_join__wZjdq",lock:"styles_lock__1XZwr",fadeIn:"styles_fadeIn__2sZze",fadeOut:"styles_fadeOut__1PK8y"}},206:function(e,t,n){"use strict";n.r(t);var a=n(1),s=n.n(a),i=n(111),c=n.n(i),r=(n(131),n(73)),o=n.n(r),l=(n(132),n(4)),u=n(18),d=n(7),h=n(9),f=function(e){localStorage.setItem("auth",JSON.stringify(e))},p=function(){var e=localStorage.getItem("auth");if(null!==e&&void 0!==e)return JSON.parse(e)},m=function(){localStorage.removeItem("auth")},g=function(){m(),window.location.reload()},_=n(56),j=n.n(_),v={VERSION:"0.3.3",PEER_JS_SERVER:{host:"peerjs-server-4zqef7rt7q-as.a.run.app",port:80},BACKEND_SERVER:"https://jam.autonomous.ai",SOCKET_SERVER:"wss://jam.autonomous.ai",SOCKET_SERVER_PATH:"/api/socket.io",IS_PRODUCTION:!0,iceServers:[{urls:"turn:34.123.205.86:1609?transport=udp",username:"Ty1",credential:"password"},{urls:"stun:34.123.205.86:1609"}],STATUS:{DISCONNECTED:"disconnected",FAILED:"failed",CONNECTED:"connected",CLOSED:"closed"},FIREBASE_CONFIG:{apiKey:"AIzaSyAsYPb7cxQSnQNjI7x4CTg-UbzxRQdE-Bg",authDomain:"pjam-293710.firebaseapp.com",databaseURL:"https://pjam-293710.firebaseio.com",projectId:"pjam-293710",storageBucket:"pjam-293710.appspot.com",messagingSenderId:"1098600099639",appId:"1:1098600099639:web:c0a3da15b6a1e9d7c234b2",measurementId:"G-RLBT5ZMKWZ"},AGORA_CONFIG:{AppId:"0f5df6f6a3a34bfcb830ace46b55c9a8"},GA_CONFIG:{trackingId:"G-H7HP1C81Y5"},AA_CONFIG:{API_KEY:"YCf3pMW4dFw4_Nl76q94JF8F5sqlNJUO"}},b=new(n(125).a)(v.IS_PRODUCTION?"prod":"dev","frontend"),O=b.createLog("Handle 403 Code"),k=n(28),y=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3;k.ToastsStore.success(e,t,"toast-message")},x=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3;k.ToastsStore.error(e,t,"toast-message")},C=v.BACKEND_SERVER,N=j.a.create({baseURL:C,timeout:1e4,headers:{"Content-Type":"application/json;charset=UTF-8"}});N.interceptors.request.use((function(e){return e}),(function(e){return Promise.reject(e)})),N.interceptors.response.use((function(e){var t=(e||{}).data||{},n=t.data,a=t.error;if(a)throw a;return n}),(function(e){var t=e.response,n=((t=void 0===t?{}:t).data||{}).errorMsg;return function(e,t){O.info(e.response);var n=e.response.status;O.info("status ",n),403===n&&t&&g()}(e,!0),Promise.reject(n||e)})),v.IS_PRODUCTION||(window.http=N);var S=N,w=n(8),T=n(2),A=n.n(T),I=n(5),E=n(126),L=n(116),R=b.createLog("Tracking"),U=new E.a({clientSecret:v.AA_CONFIG.API_KEY,debug:!v.IS_PRODUCTION}),M=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.platform,n={userId:null,userPseudoId:null},a=function(){var e=Object(I.a)(A.a.mark((function e(){var t,a;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,L.a.load();case 3:return t=e.sent,e.next=6,t.get();case 6:a=e.sent,n.userPseudoId=a.visitorId,R.info("Setup track service completed"),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),R.error("Can not finish setting up track service, but may be it still works");case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}(),s=function(e){return n.userId=e},i=function(e,a){U.trackEvent({eventName:e,eventParams:a,platform:t,userId:n.userId,userPseudoId:n.userPseudoId})},c=function(e){U.trackPageView({pageName:e,platform:t})};return{trackEvent:i,trackPage:c,setUserId:s,setup:a}}({platform:"web"}),P="CLICK_BUTTON_CONTINUE_LOGIN",B="CLICK_BUTTON_LOGIN",F="CLICK_BUTTON_RESEND_CODE",H="TYPE_INPUT_EMAIL",V="API_LOGIN_OTP_SUCCESS",K="API_LOGIN_OTP_FAIL",D="API_RESEND_OTP",G="CLICK_BUTTON_MIC",J="CLICK_BUTTON_SHARE_SCREEN",Y="CLICK_BUTTON_SHARE_SCREEN_FULLSCREEN",Q="CLICK_BUTTON_SHARE_SCREEN_MIC",W="CLICK_BUTTON_JOIN",q="CLICK_BUTTON_INVITE_FROM_LISTROOM",Z="CLICK_BUTTON_INVITE_FROM_MENU",z="CLICK_BUTTON_INVITE_FROM_EMPTY_LISTROOM",X="CLICK_BUTTON_INVITE_SEND",$="CLICK_BUTTON_FEEDBACK_FROM_MENU",ee="CLICK_BUTTON_FEEDBACK_SEND",te="CLICK_BUTTON_LOGOUT_FROM_MENU",ne="CLICK_BUTTON_HAMBURGER_MENU",ae={PRESS_ENTER:{key:"action",value:"PRESS_ENTER"},AUTO:{key:"action",value:"AUTO"},TURN_ON:{key:"action",value:"TURN_ON"},TURN_OFF:{key:"action",value:"TURN_OFF"},CLOSE:{key:"action",value:"CLOSE"},OPEN:{key:"action",value:"OPEN"}},se={SUCCESS:{key:"status",value:"SUCCESS"},FAIL:{key:"status",value:"FAIL"}},ie="LANDING_PAGE",ce="HOME",re="LOGIN",oe=n(0),le=b.createLog("AuthService",{logToServer:!0}),ue=new(function(){function e(){var t=this;Object(d.a)(this,e),this.loading=!1,this.isAuthenticated=!1,this.auth=void 0,this._onAuthChangeListener=[],this.logout=function(){!0!==t.loading&&(t.loading=!0,S.post("api/logout").then((function(e){if(!e)throw new Error("Logout failed");g(),t.auth=void 0,t.isAuthenticated=!1,t.triggerAuthChangeCallbacks(),t.loading=!1})).catch((function(e){t.loading=!1})))},this.verify=function(){!0!==t.loading&&(t.loading=!0,S.get("api/profile").then((function(e){t.loading=!1,t.isAuthenticated=!0})).catch((function(e){t.loading=!1})))},this.handleLogin=function(e,n){var a=e.token;t.isAuthenticated=!0,f(e),function(e){N.defaults.headers=Object(l.a)(Object(l.a)({},N.defaults.headers),{},{token:e})}(a),n&&n(e),t.auth=e,t.verify(),b.setUserId(e.id),b.setUserEmail(e.email),M.setUserId(e.email),le=b.createLog("AuthService",{logToServer:!0}),t.triggerAuthChangeCallbacks()},this.login=function(e,n){!0!==t.loading&&(t.loading=!0,S.post("api/login",{email:e.email,workspace:e.workspace}).then((function(e){t.loading=!1,t.handleLogin(e,n),le.info("login_request")})).catch((function(e){t.loading=!1})))},this.requestOtp=function(e,n){!0!==t.loading&&(t.loading=!0,S.post("api/login",{email:e}).then((function(e){t.loading=!1,n(e),le.info("login_request_otp")})).catch((function(e){t.loading=!1})))},this.verifyOtp=function(e,n){!0!==t.loading&&(t.loading=!0,S.post("api/complete-login",{code:e}).then((function(e){t.loading=!1,t.handleLogin(e,n),le.info("login_complete"),M.trackEvent(V)})).catch((function(e){t.loading=!1,x("This code is not valid. Please try again, or request a new one."),M.trackEvent(K)})))},this.resendOtp=function(e,n){!0!==t.loading&&(t.loading=!0,S.post("api/login",{email:e}).then((function(e){t.loading=!1,n(e),le.info("login_resend_otp"),y("New code sent."),M.trackEvent(D,[se.SUCCESS])})).catch((function(e){t.loading=!1,M.trackEvent(D,[se.FAIL])})))},this.invite=function(e,n){!0!==t.loading&&(t.loading=!0,S.post("api/invite",{emailList:e}).then((function(e){t.loading=!1,n(e)})).catch((function(e){t.loading=!1})))};var n=p();n&&(n.email&&this.handleLogin(n))}return Object(h.a)(e,[{key:"onAuthChange",value:function(e){this._onAuthChangeListener.push(e)}},{key:"triggerAuthChangeCallbacks",value:function(){var e=this;this._onAuthChangeListener.forEach((function(t){return t(e.auth)}))}}]),e}()),de=ue;function he(e){var t=e.children,n=Object(u.a)(e,["children"]),a=ue;return Object(oe.jsx)(w.b,Object(l.a)(Object(l.a)({},n),{},{render:function(e){var n=e.location;return a.isAuthenticated&&a.auth?t:Object(oe.jsx)(w.a,{to:{pathname:"/get-started",state:{from:n}}})}}))}function fe(e){var t=e.children,n=Object(u.a)(e,["children"]),a=ue;return Object(oe.jsx)(w.b,Object(l.a)(Object(l.a)({},n),{},{render:function(e){var n=e.location;return a.isAuthenticated&&a.auth?Object(oe.jsx)(w.a,{to:{pathname:"/",state:{from:n}}}):t}}))}var pe=n(27),me=(n(58),n(45),n(34),function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.join(t.length>=2?" ":"")}),ge=function(e){return"string"===typeof e&&e.substr(0,e.indexOf("@"))},_e=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},je=function(e){for(var t=[],n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",a=n.length,s=0;s<e;s++)t.push(n.charAt(Math.floor(Math.random()*a)));return t.join("")};n.p,n.p,n(76),n(52),n.p,n.p,n.p,n(59),n(77);M.trackPage(ie);var ve=n(12),be=n(3),Oe=n(26),ke=n.n(Oe),ye=n(50),xe=b.createLog("agoraClient",{logToServer:!0});ke.a.setLogLevel(v.IS_PRODUCTION?3:0);var Ce={mode:"rtc",codec:"vp8"},Ne={encoderConfig:"high_quality",AEC:!0,AGC:!0,ANS:!0},Se=function(){function e(t,n){var a=this;Object(d.a)(this,e),this.handleUserPublished=function(){var e=Object(I.a)(A.a.mark((function e(t,n){var s,i;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,xe.verbose("handleUserPublished -  Info",t,n),"audio"!==n||!t.hasAudio){e.next=7;break}return e.next=5,a.clientAgora.subscribe(t,n);case 5:(s=e.sent)&&s.play();case 7:if("video"!==n||!t.hasVideo){e.next=12;break}return e.next=10,a.clientAgora.subscribe(t,n);case 10:(i=e.sent)&&a.triggerReceiveVideoTrack(i);case 12:e.next=18;break;case 14:throw e.prev=14,e.t0=e.catch(0),xe.error("handleUserPublished failed, mediaType: ".concat(n,", uid: ").concat(t&&t.uid,", e: ").concat(e.t0.message)),e.t0;case 18:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(t,n){return e.apply(this,arguments)}}(),this.handleUserUnpublished=function(){var e=Object(I.a)(A.a.mark((function e(t,n){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,xe.verbose("user-unpublished",t,n),"video"===n&&a.triggerRemoveVideoTrack(),e.next=5,a.clientAgora.unsubscribe(t,n);case 5:e.next=11;break;case 7:throw e.prev=7,e.t0=e.catch(0),xe.critical("handleUserUnpublished failed, mediaType: ".concat(n,", e: ").concat(e.t0.message)),e.t0;case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,n){return e.apply(this,arguments)}}(),this.handleException=function(){var e=Object(I.a)(A.a.mark((function e(t){var n;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.clientAgora.getRTCStats();case 2:n=e.sent,xe.error("Agora exception with event: ".concat(JSON.stringify(t),", channelName: ").concat(a.channelName,", statsCall: ").concat(JSON.stringify(n)));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.handleNetworkQuality=function(e){e.downlinkNetworkQuality>=3&&xe.info("downlinkNetworkQuality, channelName: ".concat(a.channelName,", stats: ").concat(e.downlinkNetworkQuality)),e.uplinkNetworkQuality>=3&&xe.info("uplinkNetworkQuality, channelName: ".concat(a.channelName,", stats: ").concat(e.uplinkNetworkQuality)),a._handleAudioPacketsLost()},this.handleUserInfoUpdated=function(e,t){switch(t){case"mute-audio":a.triggerUserInfoUpdated({agoraUserId:e,status:"muted"});break;case"unmute-audio":a.triggerUserInfoUpdated({agoraUserId:e,status:"unmuted"})}},this.handleVolumeIndicator=function(e){a.triggerVolumeIndicatorChange(e)},this.setMicrophone=Object(ye.debounce)(function(){var e=Object(I.a)(A.a.mark((function e(t){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,a.microphone=t,a.localAudioTrack){e.next=6;break}return e.next=5,ke.a.createMicrophoneAudioTrack(Ne);case 5:a.localAudioTrack=e.sent;case 6:if("CONNECTED"!==a.clientAgora.connectionState||!a.localAudioTrack){e.next=14;break}if(!t){e.next=12;break}return e.next=10,a.clientAgora.publish(a.localAudioTrack);case 10:e.next=14;break;case 12:return e.next=14,a.clientAgora.unpublish(a.localAudioTrack);case 14:a.triggerMicrophoneUpdate(t),e.next=21;break;case 17:throw e.prev=17,e.t0=e.catch(0),xe.critical("setMicrophone failed, e: ".concat(e.t0.message)),e.t0;case 21:case"end":return e.stop()}}),e,null,[[0,17]])})));return function(t){return e.apply(this,arguments)}}(),500);try{this.clientId=t,this.socket=n,this.clientAgora=ke.a.createClient(Ce),this.localAudioTrack=null,this.localScreenTrack=null,this.microphone=!0,this._onReceiveVideoTrackListener=[],this._onRemoveVideoTrackListener=[],this._onConnectionStateChangeListener=[],this._onMicrophoneUpdateListener=[],this._onSharingScreenStatusChangeListener=[],this._onUserInfoUpdatedListener=[],this._onVolumeIndicatorChangeListener=[],this.channelName=null,this.totalAudioPacketsSent=0,this.totalAudioPacketsLost=0,this.packetLossEventCount=0,this.initSocketListener(),this.clientAgora.on("connection-state-change",(function(e){a.triggerConnectionStateChange(e)})),this.permissionOnchange(),this.onMicrophoneChanged(),xe.info("Init client, uid: ",this.clientAgora.uid)}catch(s){throw xe.critical("Init failed, clientId: ".concat(t,", error: ").concat(s.message)),s}}return Object(h.a)(e,[{key:"onMicrophoneChanged",value:function(){var e=this;ke.a.onMicrophoneChanged=function(){var t=Object(I.a)(A.a.mark((function t(n){var a,s;return A.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ke.a.getMicrophones(!1);case 2:if((a=t.sent)&&0!==a.length){t.next=5;break}return t.abrupt("return");case 5:(s=a.find((function(e){return"default"===e.deviceId})))&&e.localAudioTrack&&e.localAudioTrack.setDevice(s.deviceId);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}},{key:"permissionOnchange",value:function(){var e=this;navigator.permissions&&navigator.permissions.query({name:"microphone"}).then((function(t){t.onchange=function(){e.channelName&&("granted"===t.state||"prompt"===t.state?e.createAndPublishAudioTrack():e.destroyLocalAudioTrack())}}))}},{key:"onMicrophoneUpdate",value:function(e){"function"===typeof e&&this._onMicrophoneUpdateListener.push(e)}},{key:"onSharingScreenStatusChange",value:function(e){"function"===typeof e&&this._onSharingScreenStatusChangeListener.push(e)}},{key:"onConnectionStateChange",value:function(e){"function"===typeof e&&this._onConnectionStateChangeListener.push(e)}},{key:"onReceiveVideoTrack",value:function(e){"function"===typeof e&&this._onReceiveVideoTrackListener.push(e)}},{key:"onRemoveVideoTrack",value:function(e){"function"===typeof e&&this._onRemoveVideoTrackListener.push(e)}},{key:"onUserInfoUpdated",value:function(e){"function"===typeof e&&this._onUserInfoUpdatedListener.push(e)}},{key:"onVolumeIndicatorChange",value:function(e){"function"===typeof e&&this._onVolumeIndicatorChangeListener.push(e)}},{key:"triggerMicrophoneUpdate",value:function(e){this._onMicrophoneUpdateListener.forEach((function(t){return t(e)}))}},{key:"triggerReceiveVideoTrack",value:function(e){this._onReceiveVideoTrackListener.forEach((function(t){return t(e)}))}},{key:"triggerRemoveVideoTrack",value:function(){this._onRemoveVideoTrackListener.forEach((function(e){return e()}))}},{key:"triggerConnectionStateChange",value:function(e){this._onConnectionStateChangeListener.forEach((function(t){return t(e)}))}},{key:"triggerSharingScreenStateChange",value:function(e){this._onSharingScreenStatusChangeListener.forEach((function(t){return t(e)}))}},{key:"triggerUserInfoUpdated",value:function(e){this._onUserInfoUpdatedListener.forEach((function(t){return t(e)}))}},{key:"triggerVolumeIndicatorChange",value:function(e){this._onVolumeIndicatorChangeListener.forEach((function(t){return t(e)}))}},{key:"_handleAudioPacketsLost",value:function(){if(this.packetLossEventCount=this.packetLossEventCount+1,!(this.packetLossEventCount<3)){var e=this.clientAgora.getLocalAudioStats();if(e){var t=e.sendPacketsLost-this.totalAudioPacketsLost,n=e.sendPackets-this.totalAudioPacketsSent,a=t/n*100;a>=5&&xe.info("Audio packets loss: ".concat(a,"%, total packets loss: ").concat(t,", total packets sent: ").concat(n,", channelName: ").concat(this.channelName)),a>=15&&xe.critical("Audio packets loss: ".concat(a,"%, total packets loss: ").concat(t,", total packets sent: ").concat(n,", channelName: ").concat(this.channelName)),this.totalAudioPacketsLost=e.sendPacketsLost,this.totalAudioPacketsSent=e.sendPackets,this.packetLossEventCount=0}}}},{key:"start",value:function(){var e=Object(I.a)(A.a.mark((function e(t,n,a){var s,i;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.clientAgora.on("user-published",this.handleUserPublished),this.clientAgora.on("user-unpublished",this.handleUserUnpublished),this.clientAgora.enableAudioVolumeIndicator(),e.next=5,this.clientAgora.join(v.AGORA_CONFIG.appId,t,n,null);case 5:if(s=e.sent){e.next=10;break}throw i="Cannot join channel: ".concat(t),xe.critical(i),i;case 10:this.channelName=t,xe.info("join a room, channelName: ".concat(t,", uid: ").concat(s)),this.clientAgora.on("exception",this.handleException),this.clientAgora.on("network-quality",this.handleNetworkQuality),this.clientAgora.on("user-info-updated",this.handleUserInfoUpdated),this.clientAgora.on("volume-indicator",this.handleVolumeIndicator),this.createAndPublishAudioTrack(),this.updateAgoraUserId(a,s);case 18:case"end":return e.stop()}}),e,this)})));return function(t,n,a){return e.apply(this,arguments)}}()},{key:"createAndPublishAudioTrack",value:function(){var e=Object(I.a)(A.a.mark((function e(){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ke.a.createMicrophoneAudioTrack(Ne);case 3:if(this.localAudioTrack=e.sent,!this.microphone||!this.localAudioTrack){e.next=7;break}return e.next=7,this.clientAgora.publish(this.localAudioTrack);case 7:e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),xe.critical("CreateAndPublishAudioTrack failed, e: ".concat(e.t0.message)),x("Microphone permission denied");case 13:case"end":return e.stop()}}),e,this,[[0,9]])})));return function(){return e.apply(this,arguments)}}()},{key:"updateAgoraUserId",value:function(){var e=Object(I.a)(A.a.mark((function e(t,n){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.post("api/room/agora-user-id",{roomId:t,agoraUserId:n});case 2:xe.info("updateAgoraUserId, roomId: ".concat(t,", agoraUserId: ").concat(n));case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"stop",value:function(){var e=Object(I.a)(A.a.mark((function e(){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.destroyLocalAudioTrack();case 3:if(!this.localScreenTrack){e.next=8;break}return this.localScreenTrack.stop(),this.localScreenTrack.close(),e.next=8,this.clientAgora.unpublish(this.localScreenTrack);case 8:if(!this.clientAgora){e.next=11;break}return e.next=11,this.clientAgora.leave();case 11:this.channelName=null,this.totalAudioPacketsSent=0,this.totalAudioPacketsLost=0,this.packetLossEventCount=0,this.removeAllListeners(),e.next=22;break;case 18:throw e.prev=18,e.t0=e.catch(0),xe.critical("stop failed, e: ".concat(e.t0.message)),e.t0;case 22:case"end":return e.stop()}}),e,this,[[0,18]])})));return function(){return e.apply(this,arguments)}}()},{key:"removeAllListeners",value:function(){var e=Object(I.a)(A.a.mark((function e(){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.clientAgora.removeAllListeners("user-published"),this.clientAgora.removeAllListeners("user-unpublished"),this.clientAgora.removeAllListeners("exception"),this.clientAgora.removeAllListeners("network-quality"),this.clientAgora.removeAllListeners("user-info-updated"),this.clientAgora.removeAllListeners("volume-indicator");case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"destroyLocalAudioTrack",value:function(){var e=Object(I.a)(A.a.mark((function e(){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.localAudioTrack){e.next=6;break}if(this.localAudioTrack.stop(),this.localAudioTrack.close(),!this.microphone){e.next=6;break}return e.next=6,this.clientAgora.unpublish(this.localAudioTrack);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"startScreenSharing",value:function(){var e=Object(I.a)(A.a.mark((function e(t){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t){e.next=14;break}return"1080p_2","disable",e.next=6,ke.a.createScreenVideoTrack({encoderConfig:"1080p_2"},"disable");case 6:if(this.localScreenTrack=e.sent,xe.verbose("screenTrack",this.localScreenTrack),!this.localScreenTrack){e.next=12;break}return this.localScreenTrack.on("track-ended",this.endScreenSharing.bind(this)),e.next=12,this.clientAgora.publish(this.localScreenTrack);case 12:e.next=22;break;case 14:return e.next=16,ke.a.createCustomVideoTrack({mediaStreamTrack:t.getVideoTracks()[0]});case 16:if(this.localScreenTrack=e.sent,xe.verbose("screenTrack",this.localScreenTrack),!this.localScreenTrack){e.next=22;break}return this.localScreenTrack.on("track-ended",this.endScreenSharing.bind(this)),e.next=22,this.clientAgora.publish(this.localScreenTrack);case 22:e.next=28;break;case 24:throw e.prev=24,e.t0=e.catch(0),xe.error("startScreenSharing failed, e: ".concat(e.t0.message)),e.t0;case 28:case"end":return e.stop()}}),e,this,[[0,24]])})));return function(t){return e.apply(this,arguments)}}()},{key:"endScreenSharing",value:function(){var e=Object(I.a)(A.a.mark((function e(){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.triggerSharingScreenStateChange(!1),e.prev=1,this.localScreenTrack&&(this.localScreenTrack.stop(),this.localScreenTrack.close(),this.clientAgora.unpublish(this.localScreenTrack)),e.next=9;break;case 5:throw e.prev=5,e.t0=e.catch(1),xe.error("endScreenSharing failed, e: ".concat(e.t0.message)),e.t0;case 9:case"end":return e.stop()}}),e,this,[[1,5]])})));return function(){return e.apply(this,arguments)}}()},{key:"initSocketListener",value:function(){var e=this;try{this.socket.on(this.clientId,function(){var t=Object(I.a)(A.a.mark((function t(n){return A.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=n.type,t.next="offerInfo"===t.t0?3:"answerInfo"===t.t0?6:"icecandidateInfo"===t.t0?7:8;break;case 3:return t.next=5,e.onOfferReceive(n.fromUserId,n.message);case 5:case 6:case 7:return t.abrupt("break",8);case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}catch(t){throw xe.critical("initSocketListener failed, e: ".concat(t.message)),t}}},{key:"callToRemoteUsers",value:function(){var e=Object(I.a)(A.a.mark((function e(t,n,a,s){var i=this;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return xe.info("callToRemoteUsers, channelName: ".concat(t,", channelToken: ").concat(n,", remoteUserIds: ").concat(JSON.stringify(a))),e.next=3,this.start(t,n,s);case 3:a instanceof Array&&1===a.length&&a.forEach(function(){var e=Object(I.a)(A.a.mark((function e(a){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i.connect(a,t,n,s);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 4:case"end":return e.stop()}}),e,this)})));return function(t,n,a,s){return e.apply(this,arguments)}}()},{key:"connect",value:function(e,t,n,a){try{this.socket.emit("offer",JSON.stringify({toUserId:e,offerObj:{channelName:t,channelToken:n,roomId:a}}))}catch(s){throw xe.critical("connect failed, e: ".concat(s.message)),s}}},{key:"onOfferReceive",value:function(){var e=Object(I.a)(A.a.mark((function e(t,n){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(xe.info("AgoraClient onOfferReceive ".concat(t)),n){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,this.start(n.channelName,n.channelToken,n.roomId);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}(),we=n(44),Te=n(43),Ae=n(118),Ie=b.createLog("Base Socket"),Ee=function(){function e(t,n,a){Object(d.a)(this,e),this.ns=t,this.host=n,this.path=a||"",this.events={},this._prevSocket=null,this.auth=null}return Object(h.a)(e,[{key:"socket",get:function(){if(this.auth||(this.auth=de.auth),!this.auth)throw new Error('Must run "init" with auth first');var e={query:{userId:this.auth.id},auth:{token:this.auth.token}};return""!=this.path&&(e.path=this.path),this._prevSocket=this._prevSocket||Object(Ae.io)("".concat(this.host,"/").concat(this.ns),e),this._prevSocket}},{key:"_callEvent",value:function(e){var t=this.events[e];if("function"===typeof t){for(var n=arguments.length,a=new Array(n>1?n-1:0),s=1;s<n;s++)a[s-1]=arguments[s];t.apply(void 0,a)}}},{key:"init",value:function(e){this.auth=e,this.listen()}},{key:"listen",value:function(){Ie.info('Implement "listen" here')}}]),e}(),Le=b.createLog("Room Socket"),Re="listroom",Ue=new(function(e){Object(we.a)(n,e);var t=Object(Te.a)(n);function n(){var e;return Object(d.a)(this,n),(e=t.call(this,"room-management",v.SOCKET_SERVER,v.SOCKET_SERVER_PATH)).events={},e}return Object(h.a)(n,[{key:"onListRoom",value:function(e){this.events[Re]=e}},{key:"listen",value:function(){var e=this;this.socket.on("listroom",(function(t){Le.info("Got new list room",t),e._callEvent(Re,t)}))}}]),n}(Ee)),Me=b.createLog("Signal Socket"),Pe=new(function(e){Object(we.a)(n,e);var t=Object(Te.a)(n);function n(){return Object(d.a)(this,n),t.call(this,"signal-management",v.SOCKET_SERVER,v.SOCKET_SERVER_PATH)}return Object(h.a)(n,[{key:"listen",value:function(){var e=this;this.socket.on(this.userId,(function(e){Me.info("[SIGNAL data]",e)})),window.emit=function(t,n){return e.socket.emit("exchange",{id:t,data:n})}}}]),n}(Ee)),Be=n(119),Fe=n.n(Be),He=n(120),Ve=function(){function e(){Object(d.a)(this,e),this.items=[]}return Object(h.a)(e,[{key:"queue",value:function(e){this.items.push(e)}},{key:"dequeue",value:function(){return this.items.shift()}},{key:"sortByTime",value:function(){this.items=Object(ve.a)(this.items).sort((function(e,t){return e.time-t.time}))}},{key:"run",value:function(){this.sortByTime();var e,t=Object(He.a)(this.items);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.func(n.status)}}catch(a){t.e(a)}finally{t.f()}}}]),e}(),Ke=n(78),De=n.n(Ke),Ge=(b.createLog("Notification"),n.p,n.p+"static/media/pop.5302e13a.mp3"),Je=n.p+"static/media/ringtone.7fb61301.mp3",Ye=b.createLog("sound");function Qe(){return(Qe=Object(I.a)(A.a.mark((function e(){var t,n,a,s,i=arguments;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=i.length>0&&void 0!==i[0]?i[0]:{},n=t.repeatInterval,a=new Audio(Je),e.prev=2,!n){e.next=6;break}return s=setInterval((function(){return a.play()}),n),e.abrupt("return",(function(){Ye.info("turn off playNotificationSound"),clearInterval(s),a.pause()}));case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),Ye.error("Play notification sound failed, reason: ",e.t0&&e.t0.message);case 11:case"end":return e.stop()}}),e,null,[[2,8]])})))).apply(this,arguments)}var We=function(){var e=Object(I.a)(A.a.mark((function e(){var t;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(t=new Audio(Ge)).volume=.2;try{setTimeout((function(){return t.play()}),0)}catch(n){Ye.error("Play pop sound failed, reason: ",n&&n.message)}case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),qe="call-history",Ze="joiningExistedRoom",ze="incomingCall",Xe="startingNewCall",$e="missingCall",et=function(){try{var e=JSON.parse(localStorage.getItem(qe));if(e)return{users:e.users,calls:e.calls}}catch(t){localStorage.removeItem(qe)}return{users:[],calls:[]}},tt=function(){function e(){Object(d.a)(this,e)}return Object(h.a)(e,null,[{key:"get",value:function(){return et()}},{key:"add",value:function(t){var n=t.startTime,a=t.endTime,s=t.users,i=t.type,c=et();c.calls.length>=20&&c.calls.splice(0,1),c.calls.push({id:je(10),startTime:n||+new Date,endTime:a,users:s,type:i}),e.triggerOnAddNewRecord(c.calls),e.updateHistoryUsers(c,s),localStorage.setItem(qe,JSON.stringify(c))}}]),e}();tt.currentCallId=null,tt.onAddNewRecord=null,tt.onHasMissedCall=null,tt.triggerOnAddNewRecord=function(e){tt.onAddNewRecord&&"function"==typeof tt.onAddNewRecord&&tt.onAddNewRecord(e)},tt.triggerOnHasMissedCall=function(){tt.onHasMissedCall&&"function"==typeof tt.onHasMissedCall&&tt.onHasMissedCall()},tt.updateHistoryUsers=function(e,t){t.forEach((function(t){var n=e.users.find((function(e){return e.id==t.id}));n?n.callsNumber+=1:e.users.push(Object(l.a)(Object(l.a)({},t),{},{callsNumber:1}))}))},tt.getCurrentCall=function(e){return tt.currentCallId?e.calls.find((function(e){return e.id==tt.currentCallId})):e.calls[e.calls.length-1]},tt.addUsersToTheCurrentCall=function(e){var t=tt.get(),n=tt.getCurrentCall(t);n&&(n.joinedUsers=e.filter((function(e){return!n.users.find((function(t){return t.id==e.id}))})).map((function(e){return{id:e.id,email:e.email}})),tt.triggerOnAddNewRecord(t.calls),tt.updateHistoryUsers(t,n.joinedUsers),localStorage.setItem(qe,JSON.stringify(t)))},tt.updateTypeOfTheCurrentCall=function(e){var t=tt.get(),n=tt.getCurrentCall(t);n&&(n.type=e,tt.triggerOnAddNewRecord(t.calls),localStorage.setItem(qe,JSON.stringify(t)))},tt.markAllAsRead=function(){var e=tt.get();e.calls=e.calls.map((function(e){return Object(l.a)(Object(l.a)({},e),{},{isRead:!0})})),localStorage.setItem(qe,JSON.stringify(e))};var nt=tt,at=n(46),st=n.n(at),it=n.p+"static/media/mic-on-ic.902b97c7.svg",ct=n.p+"static/media/mic-off-ic.f3bb5eb3.svg",rt=b.createLog("MicrophoneManager",{logToServer:!0}),ot=function(e){var t=e.onChange,n=e.agoraClient,a=s.a.useState(n.microphone),i=Object(be.a)(a,2),c=i[0],r=i[1];return n.onMicrophoneUpdate(r),Object(oe.jsx)("div",{className:me(st.a.container,!c&&st.a.micOff),children:Object(oe.jsxs)("button",{className:st.a.wrapper,onClick:function(){var e=!c;n.setMicrophone(e),r(e),"function"===typeof t&&t(e),e?(rt.info("change_microphone_on"),M.trackEvent(G,[ae.TURN_ON])):(rt.info("change_microphone_off"),M.trackEvent(G,[ae.TURN_OFF]))},children:[Object(oe.jsx)("div",{className:st.a.icon,children:Object(oe.jsx)("img",{src:c?it:ct})}),Object(oe.jsxs)("div",{className:st.a.label,children:["Mic: ",Object(oe.jsx)("span",{children:c?"ON":"OFF"})]})]})})},lt=n(13),ut=n.n(lt),dt=n(79),ht=n.n(dt),ft=function(){return Object(oe.jsx)("div",{className:ht.a.container,children:Object(oe.jsx)("div",{className:ht.a.loader})})},pt=n(121),mt=n.n(pt),gt=function(e){var t=e.children,n=e.className,a=e.onClickAsync,i=e.onClick,c=Object(u.a)(e,["children","className","onClickAsync","onClick"]),r=s.a.useState(!1),o=Object(be.a)(r,2),d=o[0],h=o[1],f=s.a.useRef(null);s.a.useEffect((function(){return function(){console.log("Button unmouted")}}),[]);var p=Object(ye.debounce)((function(){if("function"!==typeof a)"function"===typeof i&&i();else{var e=a();if(e instanceof Promise){h(!0);Promise.all([new Promise((function(e){setTimeout((function(){return e()}),800)})),e]).finally((function(){f.current&&h(!1)}))}}}),200);return Object(oe.jsx)("button",Object(l.a)(Object(l.a)({className:me(mt.a.container,n),onClick:p},c),{},{ref:f,children:d?Object(oe.jsx)(ft,{}):t}))},_t=n.p+"static/media/screen-sharing.29688117.svg",jt=n.p+"static/media/close-ic.d84d13f8.svg",vt=function(e){var t=e.agoraClient,n=e.disabled,a=(e.isRinging,e.showMessage),i=e.onMicChange,c=s.a.useState(!1),r=Object(be.a)(c,2),o=r[0],l=r[1],u=s.a.useState(),d=Object(be.a)(u,2),h=d[0],f=d[1],p=s.a.useState(t.microphone),m=Object(be.a)(p,2),g=m[0],_=m[1],j=s.a.useState(!1),v=Object(be.a)(j,2),b=v[0],O=v[1],k=s.a.useRef(),y=function(e){navigator.getUserMedia({audio:!1,video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:e.id}}},(function(e){t.startScreenSharing(e)}),(function(e){console.log("Error when processShareScreenSource",e)}))};s.a.useEffect((function(){t.onSharingScreenStatusChange(l),t.onReceiveVideoTrack((function(e){f(e),e.play(k.current),N(!0)})),t.onRemoveVideoTrack((function(){return f(null)})),t.onMicrophoneUpdate(_),t.onConnectionStateChange((function(e){"DISCONNECTED"===e&&(f(null),l(!1))}))}),[]);var x=function(){var e=Object(I.a)(A.a.mark((function e(){var n,a,s;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,l(n=!o),!n){e.next=9;break}if(M.trackEvent(J,[ae.TURN_ON]),a=document.getElementById("global-data"),!(s=JSON.parse(a.getAttribute("screen-sources"))).length){e.next=9;break}return e.abrupt("return",y(s[0]));case 9:return M.trackEvent(J,[ae.TURN_OFF]),e.next=12,t.endScreenSharing();case 12:return e.abrupt("return",e.sent);case 15:e.prev=15,e.t0=e.catch(0),l(!1);case 18:case"end":return e.stop()}}),e,null,[[0,15]])})));return function(){return e.apply(this,arguments)}}(),C=function(){if(!n)return x();a({type:"warning",value:"Please join or start a conversation to share your screen."})},N=function(e){var t=!b;O(t),t?M.trackEvent(Y,[ae.OPEN].concat(Object(ve.a)(e?[]:[ae.AUTO]))):M.trackEvent(Y,[ae.CLOSE].concat(Object(ve.a)(e?[]:[ae.AUTO])))};return Object(oe.jsx)(s.a.Fragment,{children:Object(oe.jsx)("div",{className:me(ut.a.container,n&&ut.a.disabled,h&&ut.a.hasRemoteTrack),children:Object(oe.jsx)("button",{className:ut.a.wrapper,onClick:function(){h?b||N():C()},id:"share-screen-button",children:h?Object(oe.jsx)("div",{ref:k,className:me(ut.a.video,b&&ut.a.fullScreen),children:b&&Object(oe.jsxs)("div",{className:ut.a.controls,children:[Object(oe.jsxs)(gt,{className:ut.a.close,onClick:N,children:[Object(oe.jsx)("div",{children:Object(oe.jsx)("img",{src:jt})}),"Close"]}),Object(oe.jsx)(gt,{className:ut.a.mic,onClick:function(){var e=!g;t.setMicrophone(e),_(e),i&&i(e),e?M.trackEvent(Q,[ae.TURN_ON]):M.trackEvent(Q,[ae.TURN_OFF])},children:g?Object(oe.jsxs)(s.a.Fragment,{children:[Object(oe.jsx)("div",{children:Object(oe.jsx)("img",{src:it})}),"Mic: ",Object(oe.jsx)("span",{className:ut.a.onLabel,children:"ON"})]}):Object(oe.jsxs)(s.a.Fragment,{children:[Object(oe.jsx)("div",{children:Object(oe.jsx)("img",{src:ct})}),"Mic: ",Object(oe.jsx)("span",{className:ut.a.offLabel,children:"OFF"})]})})]})}):Object(oe.jsxs)(s.a.Fragment,{children:[Object(oe.jsx)("div",{className:ut.a.icon,children:Object(oe.jsx)("img",{src:_t})}),Object(oe.jsx)("div",{className:ut.a.label,children:o?"Stop sharing":"Share screen"})]})})})})},bt=n(35),Ot=n.n(bt),kt=n.p+"static/media/leave-ic.561f375e.svg",yt=n.p+"static/media/lock-ic.b97f6669.svg",xt=n.p+"static/media/unlock-ic.37cc8dc7.svg",Ct=n(29),Nt=n.n(Ct),St=n.p+"static/media/speaker-ic.e2e168e2.svg",wt=n.p+"static/media/speaker-ic-active.6da08791.svg",Tt=function(e){var t=e.name,n=e.id,a=e.agoraUserId,i=e.agoraClient,c=e.auth,r=s.a.useState(n===c.id&&!i.microphone),o=Object(be.a)(r,2),l=o[0],u=o[1],d=s.a.useState(!1),h=Object(be.a)(d,2),f=h[0],p=h[1];return s.a.useEffect((function(){i.onMicrophoneUpdate((function(e){n===c.id&&u(!e)}))}),[]),s.a.useEffect((function(){a&&(i.onUserInfoUpdated((function(e){e.agoraUserId===a&&u("muted"===e.status)})),i.onVolumeIndicatorChange((function(e){var t=e.find((function(e){return e.uid===a}));t&&t.level>=3?p(!0):p(!1)})))}),[a]),Object(oe.jsxs)("div",{className:me(Nt.a.container,f&&Nt.a.isSpeaking,l&&Nt.a.isMuted),children:[Object(oe.jsx)("span",{className:Nt.a.name,children:t}),l?Object(oe.jsx)("span",{className:Nt.a.mic,children:Object(oe.jsx)("img",{src:ct})}):Object(oe.jsx)("span",{className:Nt.a.mic,children:Object(oe.jsx)("img",{src:f?wt:St})}),!!f&&Object(oe.jsxs)("div",{className:Nt.a.speaking,children:[Object(oe.jsx)("div",{}),Object(oe.jsx)("div",{})]})]})},At=function(e){var t=e.data,n=e.agoraClient,a=e.showMessage,s=e.auth,i=function(){var e=Object(I.a)(A.a.mark((function e(){var s;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=t&&b.createLog("Room",{logToServer:!0,roomId:t.id}),e.prev=1,n.stop(),e.next=5,S.post("api/room/leave");case 5:a({type:"warning",value:"You left the room."}),s.info("leave_room_success, roomID: ".concat(t.id)),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),a({type:"error",value:"Couldn't leave the room. Please try again."}),s.error("leave_room_failed, room = ".concat(t.id));case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(){return e.apply(this,arguments)}}(),c=function(){var e=Object(I.a)(A.a.mark((function e(){var n;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t&&b.createLog("Room",{logToServer:!0,roomId:t.id}),e.prev=1,e.next=4,S.post("api/room/lock-status");case 4:a({type:"success",value:"You ".concat(t.isLocked?"locked":"unlocked"," the room")}),n.info("toggle_room_lock_ok, roomID: ".concat(t.id)),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(1),a({type:"error",value:"Couldn't change lock status of the room. Please try again."}),n.error("toggle_room_lock_failed, room = ".concat(t.id));case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(){return e.apply(this,arguments)}}();function r(e){var t=e.lockState;return console.log(t),t?Object(oe.jsxs)(gt,{onClickAsync:c,className:Ot.a.buttonLockRoom,children:[Object(oe.jsx)("img",{src:xt}),"Unlock"]}):Object(oe.jsxs)(gt,{onClickAsync:c,className:Ot.a.buttonLockRoom,children:[Object(oe.jsx)("img",{src:yt}),"Lock this room"]})}return Object(oe.jsxs)("div",{className:Ot.a.container,children:[Object(oe.jsx)("div",{className:Ot.a.users,children:t.users.map((function(e){return Object(oe.jsx)(Tt,{name:ge(e.email),id:e.id,agoraUserId:e.agoraUserId,agoraClient:n,auth:s},e.id)}))}),Object(oe.jsxs)("div",{className:Ot.a.action,children:[Object(oe.jsx)(r,{lockState:t.isLocked}),Object(oe.jsxs)(gt,{onClickAsync:i,className:Ot.a.button,children:[Object(oe.jsx)("img",{src:kt}),"Leave"]})]})]})},It=n.p+"static/media/tutorial-ic.15035781.svg",Et=function(e){var t=e.agoraClient,n=e.currentRoom,a=e.showMessage,i=e.auth,c=s.a.useState(!1),r=Object(be.a)(c,2),o=r[0],l=r[1],u=s.a.useState((function(){})),d=Object(be.a)(u,2),h=d[0],f=d[1],p=s.a.useState(!1),m=Object(be.a)(p,2),g=m[0],_=m[1],j=b.createLog("Room",{logToServer:!0}),v=s.a.useRef(),O=n&&n.isGroup,k=g;s.a.useEffect((function(){k=g}),[g]),s.a.useEffect((function(){j=n&&b.createLog("Room",{logToServer:!0,roomId:n.id});var e=v.current;if(e&&n){var s=n.userNames.filter((function(t){return!e.userNames.includes(t)}));s&&s.length&&(j.info("member joins the room",s),a({type:"success",value:"".concat(s.map((function(e){return _e(e)})).join(", ")," joined the room."),withSound:!0}),nt.addUsersToTheCurrentCall(n.users.filter((function(e){return e.id!==i.id}))),1===e.userNames.length&&n.id===e.id&&(j.info("received new call, notify me!"),function(e,t){var n=new Notification(e,{body:t});n&&(n.onclick=function(){window.focus(),n.close()})}("Jam now","".concat(s.join(", ")," want to talk with you")),t.setMicrophone(!1),l(!0),_(!0),function(){return Qe.apply(this,arguments)}({repeatInterval:1500}).then((function(e){return f((function(){return function(){_(!1),e()}}))})),nt.add({users:(n.users||[]).filter((function(e){return e.id!==i.id})),type:ze})));var c=e.userNames.filter((function(e){return!n.userNames.includes(e)}));j.info("member leaves the room",c),c&&c.length&&(a({type:"warning",value:"".concat(c.map((function(e){return _e(e)})).join(", ")," left the room"),withSound:!0}),1===n.userNames.length&&l(!1),!n.users.filter((function(e){return e.id!==i.id})).length&&k&&(nt.updateTypeOfTheCurrentCall($e),nt.triggerOnHasMissedCall()))}v.current=n}),[n]);var y=function(){g&&"function"===typeof h&&h()};t.onConnectionStateChange((function(e){"DISCONNECTED"===e&&"function"===typeof h&&h()}));var x=function(e){O&&l(!e)};return Object(oe.jsxs)(s.a.Fragment,{children:[Object(oe.jsxs)("div",{className:De.a.container,onClick:y,children:[Object(oe.jsx)(ot,{onChange:x,agoraClient:t,showMessage:a}),Object(oe.jsx)(vt,{isRinging:g,disabled:!O,agoraClient:t,showMessage:a,onMicChange:x}),O&&n&&!!n.users.length&&Object(oe.jsx)(At,{agoraClient:t,data:n,showMessage:a,auth:i}),o&&Object(oe.jsxs)("div",{className:De.a.tutorial,children:[Object(oe.jsx)("img",{src:It}),Object(oe.jsx)("span",{children:"Click to turn Mic on"})]})]}),o&&Object(oe.jsx)("div",{className:"app-overlay",onClick:y})]})},Lt=n(60),Rt=n.n(Lt);var Ut=function(e){var t=e.auth;return Object(oe.jsxs)("div",{className:Rt.a.container,children:[Object(oe.jsx)("div",{className:Rt.a.hello,children:"Hello"}),Object(oe.jsx)("div",{className:Rt.a.name,children:ge(t.email)})]})},Mt=n(36),Pt=n.n(Mt),Bt=n.p+"static/media/search-ic.efdcf548.svg",Ft=n(61),Ht=n.n(Ft),Vt=n(62),Kt=n.n(Vt),Dt=function(e){var t=e.onTextChange,n=e.containerClassname,a=e.inputClassname,s=e.appendComponent,i=Object(u.a)(e,["onTextChange","containerClassname","inputClassname","appendComponent"]);return Object(oe.jsxs)("div",{className:me(Kt.a.container,n),children:[Object(oe.jsx)("input",Object(l.a)(Object(l.a)({},i),{},{className:me(Kt.a.input,a),onChange:function(e){return t(e.target.value)},spellCheck:!1})),s&&Object(oe.jsx)("div",{className:Kt.a.append,children:s})]})};var Gt=function(e){var t=e.keyword,n=e.setKeyword,a=e.containerClassname;return Object(oe.jsx)("div",{className:me(Ht.a.container,a),children:Object(oe.jsx)(Dt,{containerClassname:Ht.a.input,value:t,onTextChange:n,placeholder:"Search members",appendComponent:Object(oe.jsx)("div",{className:Ht.a.append,children:Object(oe.jsx)("img",{src:Bt})})})})},Jt=n(80),Yt=n.n(Jt),Qt=n(63),Wt=n.n(Qt),qt=n(30),Zt=n.n(qt),zt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAJuSURBVHgBxVdNbtpAFH42fwIEghs4J6hzgiQ3SPegqEvYNN2wbbpkVbKBbSpxgPQETU9QeoL6BiB+BEIC+n0TOzKOHU8ccD4J8aQZz/fNe2/evDFEE+PxuJbJZC5zudzZdru1d7udZRhGjWOwJ7AdmCPTNB9Wq9XPer0+0VnX0CC2QHoN88oj1MTder3+BiGOJBHAHRcKha/Y3bW8ARDdK5VKXyLHJZzcyufzv2Bachg48MZFmDfMEHL7wOSE2tB8PreDA0aA3DoCuR/PPGH4yGsg/3NEcr+IU++UPIWACZcCOWG5XArKA67r/0mKgBdOGArlAZzzG0kZbm0Rw439OO6D4XAos9lMWq1W7Dyi0WhIDCb0ggkll6KJfr8vg8HgxfFut6uEakCV9iyMc53Z3NF0OlUkRNATnrh2ux3rJQ8QcEYBH0QTXNwj84tIQu7CzqJWW6/5IigCd0VScsIyFovFThLAnw8JyRVMeWcwB1gSX3PP78WcIYhKTA1MsljAQR7Yul9EJVxCEQ498Bc/LQFR5FGnQwOjLPq7B5zHq7iZcUfNL6JSqehUQmH/mN1sNvcQ8F1i8qBarUqn05Fmsxk5xxPBvNABm1d1G6J09qDms6SLu3K5/EkJWC6XFkKR6nWMDZ8Ui8XH65gGBNxKSkCIbslJ+11aMrTppzj6+y0ZezS45YIT5HhwyOGR7wkg6Ba45+ORRKi1Pdd7CH2YuEl50IcJdx4kJ0IvI05k63yIxGTCMeZh5ETs45TeQLG6Qdxiq6WPlDH+gQLXiyLWFuBbtIbegf3juTx2UXvPc/zxUhtB7G+U4nt/or2E/ykHP0zvHHI4AAAAAElFTkSuQmCC",Xt=function(e){var t=e.children,n=e.title,a=void 0===n?"":n,s=e.show,i=void 0!==s&&s,c=e.onClose,r=e.closeOnClickBackdrop,o=void 0!==r&&r;return i?Object(oe.jsxs)("div",{className:Zt.a.container,children:[Object(oe.jsx)("div",Object(l.a)({className:Zt.a.backdrop},o&&c?{onClick:c}:{})),Object(oe.jsxs)("div",{className:Zt.a.modal,children:[Object(oe.jsxs)("div",{className:Zt.a.headerContainer,children:[c&&Object(oe.jsx)("img",{className:Zt.a.closeBtn,src:zt,onClick:c}),Object(oe.jsx)("span",{className:Zt.a.title,children:a})]}),Object(oe.jsx)("div",{className:Zt.a.content,children:t})]})]}):null},$t=n(122),en=function(e){return $t.validate(e)},tn=n(81),nn=n.n(tn),an=function(e){var t=e.text;return Object(oe.jsx)("div",{className:nn.a.container,children:Object(oe.jsx)("span",{className:nn.a.text,children:t})})},sn=n(37),cn=n.n(sn);var rn=function(e){var t=e.emails,n=e.setEmails,a=s.a.useState(""),i=Object(be.a)(a,2),c=i[0],r=i[1],o=s.a.useState(""),l=Object(be.a)(o,2),u=l[0],d=l[1],h=function(){return t.includes(c)},f=function(){return en(c)},p=function(){return f()&&!h()},m=function(){return""===c},g=function(){return m()?"Please enter your email.":f()?h()?"Email existed.":null:"Please enter a valid email address."};return Object(oe.jsxs)("div",{className:cn.a.container,children:[Object(oe.jsxs)("div",{className:cn.a.inputEmail,children:[Object(oe.jsx)(Dt,{onKeyUp:function(e){13===e.keyCode&&(p()?(n([].concat(Object(ve.a)(t),[c])),r("")):d(g()))},className:"input ".concat(m()?"":p()?"valid":"invalid"),value:c,onTextChange:function(e){r(String(e||"").toLowerCase()),d("")},placeholder:"Enter an email address"}),Object(oe.jsx)(an,{text:u})]}),Object(oe.jsx)("div",{className:cn.a.emailList,children:t.map((function(e){return Object(oe.jsxs)("div",{className:cn.a.emailItem,children:[Object(oe.jsx)("span",{className:cn.a.email,children:e}),Object(oe.jsx)("img",{src:zt,className:cn.a.clearEmailBtn,onClick:function(){return a=e,void n(Object(ve.a)(t).filter((function(e){return e!==a})));var a}})]},e)}))})]})},on=n(82),ln=n.n(on);var un=function(e){var t=e.onSuccess,n=s.a.useState([]),a=Object(be.a)(n,2),i=a[0],c=a[1],r=function(e){!0===e&&(c([]),"function"===typeof t&&t())};return Object(oe.jsxs)("div",{className:ln.a.container,children:[Object(oe.jsx)("span",{className:ln.a.desc,children:"Press enter after each address to invite multiple people."}),Object(oe.jsx)(rn,{emails:i,setEmails:c}),Object(oe.jsx)(gt,{disabled:0===i.length,onClickAsync:function(){M.trackEvent(X),i.length>0&&de.invite(i,r)},children:"Send invitation"})]})},dn={closeModal:null,showModal:null};function hn(){dn.showModal,dn.showModal()}var fn=function(){var e=s.a.useState(!1),t=Object(be.a)(e,2),n=t[0],a=t[1],i=s.a.useState(!1),c=Object(be.a)(i,2),r=c[0],o=c[1],l=function(){return a(!0)},u=function(){return a(!1)};s.a.useEffect((function(){dn.closeModal=u,dn.showModal=l}),[a]);return Object(oe.jsx)(Xt,{show:n,onClose:function(){u(),o(!1)},title:r?"Invitation sent.":"Invite your team.",children:r?Object(oe.jsx)("span",{style:{textAlign:"center"},children:"Your team member will receive the invitation in their email inbox."}):Object(oe.jsx)(un,{onSuccess:function(){return o(!0)}})})},pn=n.p+"static/media/add-user.42a1d98b.svg",mn=function(){return Object(oe.jsx)("div",{className:Wt.a.container,onClick:function(){M.trackEvent(q),hn()},children:Object(oe.jsxs)("div",{className:Wt.a.wrapper,children:[Object(oe.jsx)("div",{className:Wt.a.icon,children:Object(oe.jsx)("img",{src:pn})}),Object(oe.jsx)("span",{children:"Invite friend"})]})})},gn=n(14),_n=n.n(gn),jn=(n.p,n.p+"static/media/lock-ic-white.0885eaa9.svg"),vn=function(e){var t=e.data;return Object(oe.jsx)("div",{className:_n.a.userName,children:ge(t.email)})},bn=function(e){var t,n=e.room,a=e.auth,s=e.agoraClient,i=(e.messageQueueManager,e.isCurrentUserTalking,e.showMessage),c=b.createLog("Room",{logToServer:!0,roomId:n.id}),r=n||{},o=r.id,l=r.users,u=a.id,d=l.concat([]).slice(0,3),h=Math.max(l.length-3,0),f=function(){var e=Object(I.a)(A.a.mark((function e(){var t,a,r;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.isLocked){e.next=3;break}return i({type:"warning",value:"You can not join a locked room."}),e.abrupt("return",null);case 3:return e.prev=3,M.trackEvent(W),c.info("Request join room",o),e.next=8,s.stop();case 8:return e.next=10,S.post("api/room/join",{roomId:o});case 10:return t=e.sent,console.log("Joined room",t,u),a=t.userIds||[],console.log("otherUsers",a),r=a.findIndex((function(e){return e===u})),a.splice(r,1),console.log("otherUsers remove myUserId",a),e.next=19,s.callToRemoteUsers(t.channelName,t.channelToken,a,o);case 19:i({type:"success",value:"You joined the room."}),c.info("join_room_success",o),c.verbose("Joined room, room info: ",t),l.length?nt.add({startTime:+new Date,type:Ze,users:l}):nt.add({startTime:+new Date,type:Xe}),e.next=30;break;case 25:e.prev=25,e.t0=e.catch(3),S.post("api/room/leave"),c.critical("join_room_failed, room = ".concat(n.id,", reason: ").concat(e.t0.message)),i({type:"error",value:"Couldn't join the room. Please try again."});case 30:case"end":return e.stop()}}),e,null,[[3,25]])})));return function(){return e.apply(this,arguments)}}(),p=function(e){return console.log(e),e.islocked?Object(oe.jsx)("div",{className:_n.a.locking,children:Object(oe.jsx)("img",{src:jn})}):null};return o?Object(oe.jsx)("div",{className:_n.a.container,children:Object(oe.jsxs)("div",{className:_n.a.wrapper,children:[Object(oe.jsxs)("div",{className:_n.a.roomStatusContainer,children:[(t=n,t.userIds.length>1&&Object(oe.jsxs)("div",{className:_n.a.talking,children:[Object(oe.jsxs)("span",{className:_n.a.talkingAnimation,children:[Object(oe.jsx)("span",{}),Object(oe.jsx)("span",{}),Object(oe.jsx)("span",{})]}),Object(oe.jsx)("span",{children:"Talking"})]})),Object(oe.jsx)(p,{islocked:n.isLocked})]}),Object(oe.jsxs)("div",{className:_n.a.users,children:[d.map((function(e,t){return Object(oe.jsx)(vn,{data:e},e.id||t)})),!!h&&Object(oe.jsxs)("div",{className:_n.a.remainingUsers,children:["+",h," other(s)"]})]}),Object(oe.jsx)("div",{className:_n.a.actions,children:Object(oe.jsx)(gt,{className:me(_n.a.button,n.isLocked?_n.a.lock:_n.a.join),onClickAsync:f,children:n.isLocked?"Locked":"Join"})})]})}):null},On=n(64),kn=n.n(On),yn=function(e){var t=e.className,n=e.text,a=void 0===n?"There isn\u2019t anyone else here at the moment.":n,s=e.inviteText;return Object(oe.jsx)("div",{className:me(kn.a.container,t),children:Object(oe.jsxs)("span",{className:kn.a.desc,children:[a,Object(oe.jsx)("span",{className:kn.a.inviteLink,onClick:function(){M.trackEvent(z,[{key:"custom_explain_text",value:a}]),hn()},children:s})]})})},xn=function(e){var t=e.listRoom,n=e.auth,a=e.agoraClient,s=e.keyword,i=void 0===s?"":s,c=e.messageQueueManager,r=e.showMessage,o=Object(ve.a)(t.filter((function(e){return!e.isYourRoom&&e&&e.search.includes(i)})));return o.length?Object(oe.jsxs)("div",{className:Yt.a.container,children:[Object(oe.jsx)(mn,{}),o.map((function(e){return(null===e||void 0===e?void 0:e.isGroup)&&(null===e||void 0===e?void 0:e.isYourRoom)?null:Object(oe.jsx)(bn,{messageQueueManager:c,showMessage:r,room:Object(l.a)({},e),auth:n,agoraClient:a},e.id)}))]}):Object(oe.jsx)(yn,{className:Yt.a.noRoom,text:i?"The person you\u2019re looking for isn\u2019t on Jam right now.":"There isn\u2019t anyone else here at the moment.",inviteText:i?"Invite them.":"Invite your team."})};var Cn=function(e){var t=e.listRoom,n=e.auth,a=e.agoraClient,s=e.keyword,i=e.messageQueueManager,c=e.onSearchKeyword,r=e.showMessage;return Object(oe.jsxs)("div",{className:Pt.a.container,children:[Object(oe.jsxs)("div",{className:Pt.a.headerBar,children:[Object(oe.jsx)("span",{className:me(Pt.a.left,Pt.a.title),children:"Your team"}),Object(oe.jsx)("div",{className:Pt.a.right,children:Object(oe.jsx)(Gt,{setKeyword:c,keyword:s,containerClassname:Pt.a.searchBox})})]}),Object(oe.jsx)(xn,{listRoom:t,auth:n,agoraClient:a,keyword:s,messageQueueManager:i,showMessage:r})]})},Nn=(b.createLog("TrollBox Socket"),"firstData"),Sn="updateData",wn=new(function(e){Object(we.a)(n,e);var t=Object(Te.a)(n);function n(){var e;return Object(d.a)(this,n),(e=t.call(this,"trollbox",v.SOCKET_SERVER,v.SOCKET_SERVER_PATH)).events={},e.auth=null,e}return Object(h.a)(n,[{key:"init",value:function(e){this.auth=e,this.listen()}},{key:"sendMessage",value:function(e){this.socket.emit("postMessage",{message:e})}},{key:"onFirstData",value:function(e){this.events[Nn]=e}},{key:"onUpdateData",value:function(e){this.events[Sn]=e}},{key:"listen",value:function(){var e=this;this.socket.on(this.auth.id,(function(t){t&&"last100messages"===t.command&&t.status&&(console.log(t,"last100messages"),e._callEvent(Nn,t.data||[]))})),this.socket.on("broadcast",(function(t){console.log(t,"broadcast"),t&&"newMessage"===t.command&&t.status&&e._callEvent(Sn,t.data)}))}}]),n}(Ee)),Tn=n(57),An=n(25),In=n.n(An),En=function e(){Object(d.a)(this,e)};En.notificationGoneTimeoutHandler=null,En.notificationHidingTimeoutHandler=null,En.notificationIntervalHandler=null,En.initialMessage={type:"",value:""},En.activeMessage=null,En.messages=[],En.clearTimeoutHandlers=function(){clearTimeout(En.notificationGoneTimeoutHandler),clearTimeout(En.notificationHidingTimeoutHandler)},En.clearIntervalHandlers=function(){clearInterval(En.notificationIntervalHandler)},En.getTheFirstMessageInQueue=function(){return En.messages.splice(0,1)[0]};var Ln=En,Rn=n.p+"static/media/trollboxsendbutton.74c120bb.svg",Un=[];var Mn=function(){var e=s.a.useState(""),t=Object(be.a)(e,2),n=t[0],a=t[1],i=s.a.useState([]),c=Object(be.a)(i,2),r=c[0],o=c[1],l=s.a.useRef(null);s.a.useEffect((function(){wn.onFirstData((function(e){o(e),Un=e,u()})),wn.onUpdateData(d)}),[]);var u=function(){l&&l.current&&l.current.scrollToBottom()},d=function(e){Un=[].concat(Object(ve.a)(Un),[e]),o(Un),u()},h=function(){wn.sendMessage(n),a("")};return Object(oe.jsxs)("div",{className:In.a.container,id:"troll-box",children:[Object(oe.jsx)("div",{className:In.a.messageWrapper,children:Object(oe.jsx)("div",{id:"data",className:In.a.messageContainer,children:Object(oe.jsx)(Tn.Scrollbars,{style:{height:"min(calc(100vh - 340px), 386px)"},ref:l,children:r.map((function(e){return e?Object(oe.jsxs)("div",{className:In.a.messageContainerSingle,children:[Object(oe.jsxs)("div",{className:In.a.senderName,children:[" ",e.email.split("@")[0],":"]}),Object(oe.jsx)("div",{className:In.a.message,children:e.message})]},e.create_at):null}))})})}),Object(oe.jsxs)("div",{className:In.a.inputContainer,children:[Object(oe.jsx)("input",{onKeyPress:function(e){13===e.which&&h()},value:n,onChange:function(e){a(e.target.value)},placeholder:"Say something...",className:In.a.inputField,spellCheck:!1}),Object(oe.jsx)("button",{onClick:h,className:In.a.submitMessage,children:Object(oe.jsx)("img",{src:Rn})})]})]})},Pn=b.createLog("Main");M.trackPage(ce);var Bn=function(e){Pn.info("main page renderer",(new Date).getTime());var t=e.showMessage,n=de.auth,i=s.a.useState([]),c=Object(be.a)(i,2),r=c[0],o=c[1],u=s.a.useState(""),d=Object(be.a)(u,2),h=d[0],f=d[1],p=s.a.useState(null),m=Object(be.a)(p,2),g=m[0],_=m[1],j=s.a.useState(),v=Object(be.a)(j,2),b=v[0],O=v[1],k=function(e){var t=Object.values(e),a=n.id;Pn.info("current user id",a),Pn.verbose("receive rooms from server",Object(ve.a)(t));var s=t.map((function(e){return Object(l.a)(Object(l.a)({},e),{},{isYourRoom:e.userIds.includes(n.id),isYourOneMemberRoom:e.isYourRoom&&1===e.userIds.length,isTwoMembersRoom:2===e.userIds.length,isGroup:e.userIds.length>1,isPersonalCall:e.isYourRoom&&e.isTwoMembersRoom,userEmails:e.users.map((function(e){return e.email})),userNames:e.users.map((function(e){return ge(e.email)})),search:e.users.map((function(e){return e.email})).join(", "),users:e.users.map((function(t){return Object(l.a)(Object(l.a)({},t),{},{agoraUserId:((e.agoraInfo||[]).find((function(e){return e.userId==t.id}))||{}).agoraUserId})}))})}));(Pn.verbose("rooms change ",s),s.length>0)&&(s.find((function(e){return e.userIds.includes(n.id)&&1===e.userIds.length}))&&(Pn.info("You are not in any group."),Pn.info("Close any opened connection."),g.stop()));O(s.find((function(e){return e.userIds.includes(n.id)}))),o(s)};if(Object(a.useEffect)((function(){return Pn.info("init socket"),Ue.init(n),Pe.init(n),wn.init(n),_(new Se(n.id,Pe.socket)),Pn.info("on list room"),Ue.onListRoom(k),function(){}}),[]),Object(a.useEffect)((function(){Pn.info("update on list room agoraClient"),Ue.onListRoom(k)}),[g]),void 0===n||!g)return null;var y=new Ve;return y?Object(oe.jsxs)("div",{className:Fe.a.container,children:[Object(oe.jsx)(Ut,{auth:n}),Object(oe.jsx)(Et,{agoraClient:g,currentRoom:b,auth:n,showMessage:t}),Object(oe.jsx)(Cn,{listRoom:r,auth:n,agoraClient:g,keyword:h,messageQueueManager:y,onSearchKeyword:f,showMessage:t}),Object(oe.jsx)(Mn,{})]}):null},Fn=n(123),Hn=n.n(Fn);var Vn=function(e){var t=e.onTimeout,n=e.timeoutSecond,i=s.a.useState(parseInt(n,10)),c=Object(be.a)(i,2),r=c[0],o=c[1],l=function(){return o(r-1)};return Object(a.useEffect)((function(){if(0!==r){var e=setInterval(l,1e3);return function(){return clearInterval(e)}}t()}),[r]),Object(oe.jsxs)(oe.Fragment,{children:[r,"s"]})},Kn=n(31),Dn=n.n(Kn),Gn=b.createLog("OTP");var Jn=function(e){e.email;var t=e.otp,n=e.setOtp,a=e.enableResend,s=e.setResendStatus,i=e.onClickResend,c=e.onLogin;return Object(oe.jsxs)("div",{className:Dn.a.container,children:[Object(oe.jsx)("p",{className:Dn.a.annouce,children:"Enter the Jam code sent to your email inbox."}),Object(oe.jsx)(Hn.a,{containerStyle:Dn.a.otpInput,inputStyle:Dn.a.inputCell,isInputNum:!0,shouldAutoFocus:!0,value:t,onChange:function(e){n(e)},numInputs:6,separator:Object(oe.jsx)("span",{})}),Object(oe.jsxs)("div",{className:Dn.a.resendContainer,children:["Didn\u2019t get the code?",a?Object(oe.jsx)("span",{className:Dn.a.resendBtn,onClick:function(){M.trackEvent(F),i()},children:"Resend"}):Object(oe.jsxs)("span",{className:Dn.a.resendCountdown,children:["Resend in ",Object(oe.jsx)(Vn,{timeoutSecond:30,onTimeout:function(){return s(!0)}})]})]}),Object(oe.jsx)(gt,{className:"button submit ".concat(6!==t.length?"disabled":""),type:"submit",onClick:function(){M.trackEvent(B),6===t.length&&(Gn.info("send otp to login",t),c(t))},children:"Login"})]})},Yn=n(38),Qn=n.n(Yn),Wn=b.createLog("Login"),qn=b.createLog("trackingLoginIssue",{logToServer:!0});function Zn(){var e=s.a.useState(""),t=Object(be.a)(e,2),n=t[0],a=t[1],i=s.a.useState(""),c=Object(be.a)(i,2),r=c[0],o=c[1],l=s.a.useState(!1),u=Object(be.a)(l,2),d=u[0],h=u[1],f=s.a.useState(""),p=Object(be.a)(f,2),m=p[0],g=p[1],_=s.a.useState(!1),j=Object(be.a)(_,2),v=j[0],b=j[1],O=Object(w.g)(),k=function(e){Wn.info("Login result received",e),qn.info("login completed ".concat(n)),setTimeout((function(){O.push("/")}),200)};var y=function(){return""===n},x=function(){return!y()&&!en(n)},C=function(e){Wn.info("on request otp success. Result: ",e),!0===e&&h(!0)},N=function(){(y()?(o("Please enter your work email."),0):!x()||(o("Please enter a valid email address."),0))&&de.requestOtp(n,C)},S=function(e){Wn.info("on resend otp success",e)};return Object(oe.jsx)("div",{className:Qn.a.container,children:d?Object(oe.jsx)(Jn,{email:n,otp:m,setOtp:g,enableResend:v,setResendStatus:b,onClickResend:function(){b(!1),de.resendOtp(n,S)},onLogin:function(e){Wn.info("request login with new code. "+e),de.verifyOtp(m,k)}}):Object(oe.jsxs)("div",{className:Qn.a.form,children:[Object(oe.jsx)("h3",{className:Qn.a.loginTitle,children:"Welcome to JAM"}),Object(oe.jsxs)("div",{className:Qn.a.inputContainer,children:[Object(oe.jsx)(Dt,{className:Qn.a.input,type:"text",placeholder:"Enter your work email",maxLength:100,value:n,onTextChange:function(e){a(String(e||"").toLowerCase()),o("")},onKeyUp:function(e){13===e.keyCode&&(M.trackEvent(P,[ae.PRESS_ENTER]),N())},onFocus:function(){return M.trackEvent(H)}}),!!r.length&&Object(oe.jsx)(an,{text:r})]}),Object(oe.jsx)(gt,{className:Qn.a.submitButton,onClick:function(){M.trackEvent(P),N()},children:"Continue"})]})})}M.trackPage(re);var zn=function(){return Object(oe.jsx)(Zn,{})},Xn=n(124),$n=n.n(Xn),ea=function(e){var t=e.onTextChange,n=e.className,a=Object(u.a)(e,["onTextChange","className"]);return Object(oe.jsx)("textarea",Object(l.a)(Object(l.a)({maxLength:1e3},a),{},{className:me($n.a.container,n),onChange:function(e){return t(e.target.value)}}))},ta=n(65),na=n.n(ta),aa=function(e){var t=e.onSuccess,n=s.a.useState(""),a=Object(be.a)(n,2),i=a[0],c=a[1],r=s.a.useState(!0),o=Object(be.a)(r,2),l=o[0],u=o[1],d=de.auth.email,h=navigator&&navigator.userAgent,f=function(){u("Sorry, can not send your feedback, please try again")};return Object(oe.jsxs)("div",{className:na.a.container,children:[Object(oe.jsxs)("div",{className:na.a.contentContainer,children:[Object(oe.jsx)(ea,{onTextChange:function(e){c(e),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";try{return e.split(/[\n, ]/g).filter(Boolean).length}catch(t){return e.length}}(e)<3?u("The feedback is too short"):u("")},value:i,className:na.a.textarea,placeholder:"Share your thoughts here."}),Object(oe.jsx)(an,{text:l})]}),Object(oe.jsx)(gt,{disabled:l,onClickAsync:function(){return M.trackEvent(ee),S.post("api/send-feedback",{email:d,content:i,other:h}).then(t).catch(f)},children:"Submit"})]})},sa={closeModal:null,showModal:null};function ia(){sa.showModal,sa.showModal()}var ca=function(){var e=s.a.useState(!1),t=Object(be.a)(e,2),n=t[0],a=t[1],i=s.a.useState(!1),c=Object(be.a)(i,2),r=c[0],o=c[1],l=function(){return a(!0)},u=function(){return a(!1)};s.a.useEffect((function(){sa.closeModal=u,sa.showModal=l}),[]);return Object(oe.jsx)(Xt,{show:n,onClose:function(){u(),o(!1)},title:r?"Thanks for sharing your thoughts.":"How would you improve JAM?",children:r?Object(oe.jsx)("span",{style:{textAlign:"center"},children:"Your feedback will be super helpful. Thanks for using Jam!"}):Object(oe.jsx)(aa,{onSuccess:function(){return o(!0)}})})},ra=n(11),oa=n.n(ra),la=n(83),ua=n.n(la),da=n(39),ha=n.n(da),fa=function(e){return e<10?"0".concat(e):e},pa=function(e){var t=new Date(e);return"".concat(t.getFullYear(),"/").concat(fa(t.getMonth()+1),"/").concat(fa(t.getDate()),"\n\t\t\t").concat(fa(t.getHours()),":").concat(fa(t.getMinutes()),"\n\t")},ma=function(e){var t=e.type,n=e.users,a=e.startTime,s=(e.endTime,e.joinedUsers),i=e.isRead;return Object(oe.jsxs)("div",{className:me(ha.a.container,i&&ha.a.isRead),children:[Object(oe.jsxs)("div",{className:ha.a.message,children:[function(){switch(t){case Ze:return Object(oe.jsxs)("span",{children:["You ",Object(oe.jsx)("span",{className:ha.a.joining,children:"joined"})," room with"]});case ze:return Object(oe.jsx)("span",{children:"You received a call from"});case $e:return Object(oe.jsxs)("span",{children:["You ",Object(oe.jsx)("span",{className:ha.a.missing,children:"missed"})," a call from"]});default:return Object(oe.jsx)("span",{children:"You called with"})}}()," ",!!n.length&&function(){var e=n.concat(s||[]);return 1==e.length?Object(oe.jsx)("b",{children:_e(ge(e[0].email))}):2==e.length?Object(oe.jsxs)(oe.Fragment,{children:[Object(oe.jsx)("b",{children:_e(ge(e[0].email))})," and ",Object(oe.jsx)("b",{children:_e(ge(e[1].email))})]}):Object(oe.jsxs)(oe.Fragment,{children:[Object(oe.jsx)("b",{children:_e(ge(e[0].email))}),", ",Object(oe.jsx)("b",{children:_e(ge(e[1].email))})," and ",Object(oe.jsxs)("b",{children:[e.length-2," other(s)"]})]})}(),"."]}),Object(oe.jsx)("div",{className:ha.a.time,children:pa(a)})]})},ga=function(){var e=s.a.useState(nt.get().calls),t=Object(be.a)(e,2),n=t[0],a=t[1];return s.a.useEffect((function(){nt.onAddNewRecord=a,nt.markAllAsRead()}),[]),Object(oe.jsx)("div",{className:ua.a.container,children:Object(oe.jsx)(Tn.Scrollbars,{className:"activities-scrollbar",style:{width:280,maxHeight:"480px"},children:n.length?n.concat([]).reverse().map((function(e){return Object(oe.jsx)(ma,Object(l.a)({},Object(l.a)(Object(l.a)({},e),{},{key:"".concat(e.startTime,"-").concat(e.endTime)})))})):Object(oe.jsx)("div",{className:ua.a.empty,children:" There's no activity at the moment."})})})},_a=n.p+"static/media/pulse.9a71fa96.svg",ja=n.p+"static/media/bell-ic.fadacd03.svg";var va,ba=function(){var e=s.a.useState(!1),t=Object(be.a)(e,2),n=t[0],a=t[1],i=s.a.useState(!1),c=Object(be.a)(i,2),r=c[0],o=c[1],l=s.a.useState(de.auth),u=Object(be.a)(l,2),d=u[0],h=u[1],f=Object(w.g)(),p=s.a.useRef(null),m=s.a.useRef(null),g=s.a.useRef(null),_=s.a.useRef(null);s.a.useEffect((function(){nt.onHasMissedCall=function(){o(!0)},de.onAuthChange(h);var e=function(e){m.current&&m.current.contains(e.target)?console.log("Clicked inside menu"):a(!1),g.current&&g.current.contains(e.target)||_.current&&_.current.contains(e.target)?console.log("Clicked inside activities"):o(!1)};return window.addEventListener("click",e),function(){window.removeEventListener("click",e)}}),[]);var j=function(){a(!n)};return Object(oe.jsxs)("div",{className:me(oa.a.container,d&&d.workspace&&oa.a.hasWorkspace),children:[Object(oe.jsxs)("div",{className:oa.a.title,onClick:function(){return f.push("/")},children:["JAM",Object(oe.jsx)("img",{src:_a,className:oa.a.icon}),d&&d.workspace&&Object(oe.jsx)("span",{className:oa.a.workspace,children:d.workspace})]}),d?Object(oe.jsxs)("div",{className:oa.a.actions,children:[Object(oe.jsx)("button",{className:oa.a.feedbackButton,onClick:function(){return M.trackEvent($),ia()},children:"Send feedback"}),Object(oe.jsx)("div",{className:oa.a.activities,ref:g,children:Object(oe.jsx)("button",{onClick:function(){o(!r)},children:Object(oe.jsx)("img",{src:ja})})}),r&&Object(oe.jsx)("div",{ref:_,children:Object(oe.jsx)(ga,{})}),Object(oe.jsxs)("button",{className:oa.a.hamburger,onClick:function(){return M.trackEvent(ne),j()},ref:m,children:[Object(oe.jsx)("div",{className:oa.a.line}),Object(oe.jsx)("div",{className:oa.a.line}),Object(oe.jsx)("div",{className:oa.a.line})]}),n?Object(oe.jsxs)("div",{className:oa.a.menu,ref:p,children:[Object(oe.jsx)("div",{className:oa.a.item,onClick:function(){M.trackEvent(Z),hn()},children:"Invite your team"}),Object(oe.jsx)("div",{className:oa.a.item,onClick:function(){return M.trackEvent($),ia()},children:"Send feedback"}),Object(oe.jsx)("div",{className:oa.a.item,onClick:function(){M.trackEvent(te),de.logout()},children:"Log out"})]}):""]}):""]})},Oa=n(47),ka=n.n(Oa),ya=function(e){var t=e.type,n=e.message,a=e.shown,s=e.hiding;return Object(oe.jsx)("div",{className:me(ka.a.container,s&&ka.a.hiding,a&&ka.a.shown),children:Object(oe.jsx)("div",{className:me(ka.a.wrapper,ka.a[t]),children:n})})},xa=function(e){return function(t){return s.a.useEffect((function(){console.log("Load scripts..."),function(){if("undefined"!=typeof window&&v.GA_CONFIG&&v.GA_CONFIG.trackingId){var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=".concat(v.GA_CONFIG.trackingId);var t=document.createElement("script");t.innerHTML="\n\t\t\twindow.dataLayer = window.dataLayer || [];\n\t\t\tfunction gtag(){dataLayer.push(arguments);}\n\t\t\tgtag('js', new Date());\n\t\t\tgtag('config', '".concat(v.GA_CONFIG.trackingId,"');\n\t\t");var n=document.getElementsByTagName("head")[0];n.appendChild(e),e.onload=function(){n.appendChild(t)}}}()}),[]),Object(oe.jsx)(e,Object(l.a)({},t))}}((va=function(e){var t=e.message,n=e.showMessage;return Object(oe.jsx)("div",{className:o.a.container,children:Object(oe.jsxs)(pe.a,{children:[Object(oe.jsx)(ba,{authService:de}),Object(oe.jsx)(ya,{type:t.type,message:t.value,shown:t.shown,hiding:t.hiding}),Object(oe.jsxs)("div",{className:o.a.appContainer,children:[Object(oe.jsx)(ca,{}),Object(oe.jsx)(fn,{}),Object(oe.jsx)(k.ToastsContainer,{store:k.ToastsStore,position:k.ToastsContainerPosition.TOP_RIGHT}),Object(oe.jsxs)(w.d,{children:[Object(oe.jsx)(he,{exact:!0,path:"/",children:Object(oe.jsx)(Bn,{showMessage:n})}),Object(oe.jsx)(fe,{path:"/login",children:Object(oe.jsx)(zn,{})}),Object(oe.jsx)(w.b,{path:"/get-started",children:Object(oe.jsx)(zn,{})})]})]})]})})},function(e){var t=s.a.useState(Object(l.a)(Object(l.a)({},Ln.initialMessage),{},{shown:!1,hiding:!1})),n=Object(be.a)(t,2),a=n[0],i=n[1],c=function(){Ln.messages.length?(Ln.activeMessage=Ln.getTheFirstMessageInQueue(),Ln.activeMessage.withSound&&We(),i(Object(l.a)(Object(l.a)({},Ln.activeMessage),{},{shown:!0,hiding:!1})),Ln.isShowingMessage=!0):(Ln.clearIntervalHandlers(),Ln.notificationHidingTimeoutHandler=setTimeout((function(){i(Object(l.a)(Object(l.a)({},Ln.activeMessage),{},{shown:!0,hiding:!0})),Ln.notificationGoneTimeoutHandler=setTimeout((function(){i(Object(l.a)(Object(l.a)({},Ln.activeMessage),{},{value:"",shown:!1,hiding:!1})),Ln.activeMessage=null}),200)}),3e3))};return Object(oe.jsx)(va,Object(l.a)({},Object(l.a)(Object(l.a)({},e),{},{message:a,showMessage:function(e){var t=e.type,n=e.value,s=e.withSound;Ln.clearIntervalHandlers(),Ln.clearTimeoutHandlers(),a.type===t&&a.value===n||(Ln.messages.length>2&&Ln.messages.splice(Ln.messages.length-1,1),Ln.messages.push({type:t,value:n,withSound:s})),Ln.activeMessage||c(),Ln.notificationIntervalHandler=setInterval((function(){c()}),1500)}})))})),Ca=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,207)).then((function(t){var n=t.getCLS,a=t.getFID,s=t.getFCP,i=t.getLCP,c=t.getTTFB;n(e),a(e),s(e),i(e),c(e)}))},Na=b.createLog("Index file");Na.info("App is runing on mode:",v.IS_PRODUCTION?"production 123":"development"),Na.info("App version:",v.VERSION),M.setup(),c.a.render(Object(oe.jsx)(s.a.StrictMode,{children:Object(oe.jsx)(xa,{})}),document.getElementById("root")),Ca()},25:function(e,t,n){e.exports={container:"styles_container__yFNoJ",messageWrapper:"styles_messageWrapper__1TQgp",messageContainer:"styles_messageContainer__2NZXU",messageContainerSingle:"styles_messageContainerSingle__3j54f",senderName:"styles_senderName__1WJZD",message:"styles_message__3aAKj",inputContainer:"styles_inputContainer__1diS3",submitMessage:"styles_submitMessage__1SHKk",inputField:"styles_inputField__zkLtH"}},29:function(e,t,n){e.exports={container:"styles_container___Z3sm",isSpeaking:"styles_isSpeaking__2b8uj",mic:"styles_mic__1lkLN",isMuted:"styles_isMuted__Avq69",name:"styles_name__3cTuJ",speaking:"styles_speaking__2TCRx",pulse1:"styles_pulse1___mH_Q",pulse2:"styles_pulse2__m8AK6"}},30:function(e,t,n){e.exports={container:"styles_container__1Ken0",backdrop:"styles_backdrop__12n1F",modal:"styles_modal__3LbiY",headerContainer:"styles_headerContainer__3Oo4Z",title:"styles_title__SASG2",closeBtn:"styles_closeBtn__7Hpzb",content:"styles_content__1wvHn"}},31:function(e,t,n){e.exports={container:"styles_container__2vqIY",annouce:"styles_annouce__13EgD",otpInput:"styles_otpInput__1NXEV",inputCell:"styles_inputCell__34iu2",resendContainer:"styles_resendContainer__15PSP",resendBtn:"styles_resendBtn__1lOHz",resendCountdown:"styles_resendCountdown__2VaKN"}},34:function(e,t,n){e.exports={container:"styles_container__190_R",wrapper:"styles_wrapper__3Hsgi",mainImage:"styles_mainImage__1ZSP7",mobile:"styles_mobile__fVCQt",desk:"styles_desk__Un0Su"}},35:function(e,t,n){e.exports={container:"styles_container__3saYk",users:"styles_users__3BS-f",action:"styles_action__1aXfR",button:"styles_button__2R28y",buttonLockRoom:"styles_buttonLockRoom__3dkAf"}},36:function(e,t,n){e.exports={container:"styles_container__258lj",headerBar:"styles_headerBar__3EV3e",right:"styles_right__1yYsk",left:"styles_left__3I84A",searchBox:"styles_searchBox__jtRRp",invite:"styles_invite__2t27C"}},37:function(e,t,n){e.exports={container:"styles_container__30gyY",inputEmail:"styles_inputEmail__3CLI0",addBtn:"styles_addBtn__3WJ0l",emailList:"styles_emailList__1oHel",emailItem:"styles_emailItem__1X_PI",email:"styles_email__3WF7P",clearEmailBtn:"styles_clearEmailBtn__3p2YR"}},38:function(e,t,n){e.exports={container:"styles_container__1ue48",form:"styles_form__PNMni",inputContainer:"styles_inputContainer__39SmI",submitButton:"styles_submitButton__3GBd4",loginTitle:"styles_loginTitle__1C1ye"}},39:function(e,t,n){e.exports={container:"styles_container__29AsA",isRead:"styles_isRead__3dcY9",message:"styles_message__aYhkQ",missing:"styles_missing__2uOw1",joining:"styles_joining__3Jr5U",time:"styles_time__3638F",name:"styles_name__1e36w"}},45:function(e,t,n){e.exports={container:"styles_container___3-Jo",wrapper:"styles_wrapper__pDNQS",title:"styles_title__3NY_j",description:"styles_description__1zlPK",actions:"styles_actions__2TQqe"}},46:function(e,t,n){e.exports={container:"styles_container__BgyV7",wrapper:"styles_wrapper__1PxYW",icon:"styles_icon__3mh-z",label:"styles_label__XV5tt",micOff:"styles_micOff__4n2nV"}},47:function(e,t,n){e.exports={container:"styles_container__1BkX7",shown:"styles_shown__3vMmG",fadeIn:"styles_fadeIn__2sYkT",hiding:"styles_hiding__3S_ey",fadeOut:"styles_fadeOut__1mnOL",wrapper:"styles_wrapper__bNuwp",success:"styles_success__I1hLo",error:"styles_error__1WYJi",warning:"styles_warning__1oMJi",upAndDown:"styles_upAndDown__2DoLm"}},52:function(e,t,n){e.exports={container:"styles_container__2WOut",icon:"styles_icon__3XwCv",title:"styles_title__3hKG4",description:"styles_description__2cbAg"}},58:function(e,t,n){e.exports={container:"styles_container__ttgLw",fullWidth:"styles_fullWidth__39sy6"}},59:function(e,t,n){e.exports={container:"styles_container__2v12R",title:"styles_title__3WmO7",action:"styles_action__2aVo0"}},60:function(e,t,n){e.exports={container:"styles_container__dPyc1",hello:"styles_hello__2wCMj",name:"styles_name__yILLb"}},61:function(e,t,n){e.exports={container:"styles_container__27o-r",input:"styles_input__ZOqoE",append:"styles_append__2nFxc"}},62:function(e,t,n){e.exports={container:"styles_container__30PM3",input:"styles_input__2hQnB",append:"styles_append__3Bdx7"}},63:function(e,t,n){e.exports={container:"styles_container__2vT8m",wrapper:"styles_wrapper__2f_WL",icon:"styles_icon__2nxkR"}},64:function(e,t,n){e.exports={container:"styles_container__3BZXA",desc:"styles_desc__2RS3r",inviteLink:"styles_inviteLink__Hd-cl"}},65:function(e,t,n){e.exports={container:"styles_container__1RfIw",contentContainer:"styles_contentContainer__1353V",textarea:"styles_textarea__pyLnp"}},73:function(e,t,n){e.exports={appContainer:"App_appContainer__1hNk1"}},76:function(e,t,n){e.exports={container:"styles_container__3r-5T",wrapper:"styles_wrapper__2KXN9"}},77:function(e,t,n){e.exports={container:"styles_container__HCHsW",copyright:"styles_copyright__1vf4Q"}},78:function(e,t,n){e.exports={container:"styles_container__3SnZE",tutorial:"styles_tutorial__WGiEM"}},79:function(e,t,n){e.exports={container:"styles_container__1lhW0",loader:"styles_loader__1rTYe",load7:"styles_load7__31Ju9"}},80:function(e,t,n){e.exports={container:"styles_container__3nNFz",noRoom:"styles_noRoom__3px2z"}},81:function(e,t,n){e.exports={container:"styles_container__1g9Sd",text:"styles_text__1GP7y"}},82:function(e,t,n){e.exports={container:"styles_container__2nMVv",desc:"styles_desc__1sELS"}},83:function(e,t,n){e.exports={container:"styles_container__AiTEL",empty:"styles_empty__308q5"}}},[[206,1,2]]]);
//# sourceMappingURL=main.a0e68375.chunk.js.map